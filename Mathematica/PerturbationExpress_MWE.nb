(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    166458,       3867]
NotebookOptionsPosition[    165725,       3846]
NotebookOutlinePosition[    166183,       3864]
CellTagsIndexPosition[    166140,       3861]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["PerturbationExpress: MWE", "Title",
 CellChangeTimes->{{3.8293036817135725`*^9, 3.8293037084374113`*^9}, {
  3.9036970467983446`*^9, 3.9036970993867397`*^9}, {3.9042164739298787`*^9, 
  3.904216485224306*^9}, {3.9072391169590387`*^9, 3.907239119377509*^9}, {
  3.941071663514744*^9, 3.941071684217415*^9}, {3.9737034096066155`*^9, 
  3.9737034098856187`*^9}},ExpressionUUID->"1f5da4ee-bde6-40e6-94c6-\
2c14c5b91140"],

Cell[TextData[{
 "This notebook and the companion plotting notebook present a minimal code \
that allows reproducing the results described in arXiv:2504.13251. \n",
 StyleBox["NOTE: ",
  FontWeight->"Bold"],
 "This PerturbationExpress notebook should be run before the plotting \
routine. It will save the appropriate function definitions to memory, but \
will not calculate anything explicitly.\n\nThe computation is performed using \
the formalism of arXiv:1010.3693. Notice that all quantities are calculated \
using the number of e-folds, ",
 Cell[BoxData[
  FormBox["N", TraditionalForm]],ExpressionUUID->
  "bc4357d6-3114-4c61-8844-569f09b4b168"],
 ", as a time coordinate. The model parameters considered below are the ones \
used in our companion paper arXiv:2512.04199 (Table I). \n\n",
 StyleBox["The authors: ",
  FontSlant->"Italic"],
 "Dario Lorenzoni, Sarah Geller, David Kaiser, Evan McDonough\nFor \
information and assistance, contact: lorenzod@myumanitoba.ca "
}], "Text",
 CellChangeTimes->{{3.826404382934174*^9, 3.826404469864811*^9}, 
   3.8264068049599743`*^9, {3.828215517728732*^9, 3.828215540346987*^9}, {
   3.829491219311577*^9, 3.829491227162784*^9}, {3.854127361295309*^9, 
   3.854127382369823*^9}, {3.916851350181566*^9, 3.9168513622081194`*^9}, {
   3.916860783685199*^9, 3.9168610752180758`*^9}, 3.9737034289041953`*^9, {
   3.9737036084887424`*^9, 3.973703666562437*^9}, {3.973885999901475*^9, 
   3.973886130935413*^9}, 
   3.973887502211006*^9},ExpressionUUID->"2eff1238-b8f3-4bf1-911a-\
30d35120656e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"===", "===", "==="}], "=", " ", 
    RowBox[{
     RowBox[{"SETUP", " ", "===", "===", "==="}], "="}]}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
    "Needs", "[", 
     "\"\<DifferentialEquations`InterpolatingFunctionAnatomy`\>\"", "]"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "ParallelNeeds", "[", 
     "\"\<DifferentialEquations`InterpolatingFunctionAnatomy`\>\"", "]"}], 
    ";"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"Physical", " ", 
     RowBox[{"parameters", ":"}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"Mp", "=", "1"}], ";"}], "                     ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"set", " ", "M_Planck"}], "=", 
     RowBox[{"1", " ", "throughout"}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"Ninitial", "=", "0"}], ";"}], "               ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"start", " ", "computation", " ", "at", " ", "N"}], "=", "0"}], 
    "*)"}], "\n", 
   RowBox[{
    RowBox[{"Nstar", "=", "56"}], ";"}], "                 ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"exit", " ", "of", " ", "CMB", " ", "scales"}], ",", " ", 
     RowBox[{
     "as", " ", "calculated", " ", "both", " ", "analytically", " ", "and", 
      " ", "numerically"}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"NeHX", ":=", 
     RowBox[{"NendReal", "-", 
      RowBox[{"{", "Nstar", "}"}]}]}], ";"}], "   ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "list", " ", "of", " ", "modes", " ", "for", " ", "which", " ", "to", " ",
      "compute", " ", "the", " ", "perturbations"}], " ", "*)"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"Default", " ", "code", " ", 
     RowBox[{"parameters", ":"}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"saveSols", "=", "True"}], ";"}], "            ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "save", " ", "numerical", " ", "solutions", " ", "in", " ", "memory", " ", 
     RowBox[{"(", 
      RowBox[{
      "not", " ", "suitable", " ", "when", " ", "computing", " ", "many", " ",
        "modes"}], ")"}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"writeSols", "=", "True"}], ";", " ", 
    RowBox[{"writeObservables", "=", "False"}], ";", " ", 
    RowBox[{"outfilename", "=", "\"\<test\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Npivot", "=", "0"}], ";"}], "                 ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"artificial", " ", "pivot", " ", "scale"}], " ", "-", " ", 
     RowBox[{
     "useful", " ", "for", " ", "heavy", " ", "mode", " ", "computations"}]}],
     " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"NendSkip", "=", "0"}], ";"}], "               ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "artificial", " ", "buffer", " ", "to", " ", "skip", " ", "oscillatory", 
     " ", "numerics"}], " ", "*)"}], "\n", "\n", 
   RowBox[{
    RowBox[{"workPrecs", "=", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"25", ",", 
       RowBox[{"Length", "[", "NeHX", "]"}]}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "numerical", " ", "working", " ", "precision", " ", "for", " ", 
     "perturbations"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"precGoals", "=", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"20", ",", 
       RowBox[{"Length", "[", "NeHX", "]"}]}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "numerical", " ", "precision", " ", "goal", " ", "for", " ", 
     "perturbations"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"accGoals", "=", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"30", ",", 
       RowBox[{"Length", "[", "NeHX", "]"}]}], "]"}]}], ";"}], "  ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "numerical", " ", "accuracy", " ", "goal", " ", "for", " ", 
     "perturbations"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"bgWorkPrec", "=", "50"}], ";"}], "            ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "numerical", " ", "working", " ", "precision", " ", "for", " ", 
     "background"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"bgPrecGoal", "=", "50"}], ";"}], "            ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "numerical", " ", "precision", " ", "goal", " ", "for", " ", 
     "background"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"bgAccGoal", "=", "50"}], ";"}], "             ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "numerical", " ", "accuracy", " ", "goal", " ", "for", " ", 
     "background"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"solveMethod", "=", 
     RowBox[{"{", 
      RowBox[{"\"\<EquationSimplification\>\"", "->", "\"\<Solve\>\""}], 
      "}"}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"method", " ", "for", " ", "the", " ", 
     RowBox[{"perturbations", "'"}], " ", "NDSolve"}], " ", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"allSols", "=", 
     RowBox[{"{", "}"}]}], ";"}], "               ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "will", " ", "be", " ", "filled", " ", "with", " ", "perturbation", " ", 
     "solutions"}], " ", "*)"}]}]}]], "Code",
 CellChangeTimes->{{3.907239257980465*^9, 3.9072392716820545`*^9}, {
   3.907239307540792*^9, 3.907239307861988*^9}, {3.907239479123554*^9, 
   3.9072394851006994`*^9}, 3.907242813942196*^9, 3.907250541991188*^9, 
   3.9072514312218523`*^9, {3.9072522184721794`*^9, 3.907252218927195*^9}, {
   3.907252654006892*^9, 3.9072526571968374`*^9}, 3.907253181890085*^9, 
   3.907257622675143*^9, {3.9072859861920843`*^9, 3.907285993473794*^9}, {
   3.907288014026697*^9, 3.9072880215576115`*^9}, {3.9072882550088477`*^9, 
   3.9072882698646655`*^9}, {3.9072892402808113`*^9, 
   3.9072892404278135`*^9}, {3.9072931066600895`*^9, 3.90729310718707*^9}, {
   3.9110647015583587`*^9, 3.9110647051295614`*^9}, {3.911064807830504*^9, 
   3.9110648198568788`*^9}, {3.9110655527079678`*^9, 3.911065553227905*^9}, {
   3.911068293830315*^9, 3.9110682942068496`*^9}, 3.9112971543433123`*^9, 
   3.9156180333574123`*^9, {3.915618344989703*^9, 3.9156184443997393`*^9}, {
   3.9163417548724256`*^9, 3.916341878225954*^9}, {3.916772890180328*^9, 
   3.91677289026493*^9}, {3.916848906421151*^9, 3.916848911230871*^9}, 
   3.919186501082734*^9, 3.91918671879287*^9, {3.9191912282901106`*^9, 
   3.9191913396334667`*^9}, {3.919191594226827*^9, 3.919191606380517*^9}, {
   3.9192463072636414`*^9, 3.9192463206477933`*^9}, {3.921767723411688*^9, 
   3.921767740620323*^9}, {3.921768099344556*^9, 3.921768103801802*^9}, {
   3.921768177378195*^9, 3.9217681827790327`*^9}, {3.921768251785661*^9, 
   3.921768264613077*^9}, 3.9217693935207825`*^9, {3.921853698488742*^9, 
   3.9218536996077347`*^9}, {3.9218904945454063`*^9, 
   3.9218905036952047`*^9}, {3.921931705829965*^9, 3.921931743467585*^9}, {
   3.921932127925335*^9, 3.921932132381242*^9}, {3.921932350267935*^9, 
   3.921932357322545*^9}, 3.921942801894487*^9, 3.9219434065231447`*^9, {
   3.9219616135092025`*^9, 3.921961619554659*^9}, {3.9219616810156155`*^9, 
   3.921961686165311*^9}, 3.92196203151962*^9, 3.9219860915599575`*^9, {
   3.921989712301176*^9, 3.9219897634008684`*^9}, {3.922011396562654*^9, 
   3.92201140254569*^9}, {3.922183089788104*^9, 3.9221830918499336`*^9}, {
   3.9221843146585026`*^9, 3.922184317007973*^9}, {3.9222122090569477`*^9, 
   3.922212210712455*^9}, {3.9222130461516876`*^9, 3.922213046295961*^9}, {
   3.9223669658649783`*^9, 3.922367017457169*^9}, {3.922367062615971*^9, 
   3.9223670681205635`*^9}, 3.922383189304617*^9, {3.922720823861024*^9, 
   3.922720824419314*^9}, {3.922725211810498*^9, 3.922725213937941*^9}, {
   3.9227255437174773`*^9, 3.9227255440924597`*^9}, {3.922837644175519*^9, 
   3.922837703972691*^9}, {3.9228377847058105`*^9, 3.922837789115348*^9}, {
   3.9228378887932873`*^9, 3.922837932509862*^9}, 3.922838236747141*^9, {
   3.92283973134758*^9, 3.9228397785566773`*^9}, {3.923049881144972*^9, 
   3.923049882125285*^9}, {3.9230501807324495`*^9, 3.923050194902553*^9}, {
   3.9248879008396654`*^9, 3.9248879364629555`*^9}, {3.924888288190909*^9, 
   3.9248882886586437`*^9}, {3.9249681520519867`*^9, 
   3.9249681554527426`*^9}, {3.924968203337705*^9, 3.9249682191312566`*^9}, {
   3.924968270039523*^9, 3.924968299046757*^9}, {3.9249683393684263`*^9, 
   3.924968340066104*^9}, {3.9249700103783817`*^9, 3.9249700119323063`*^9}, 
   3.924972617517103*^9, 3.9249726587700787`*^9, {3.924978224483869*^9, 
   3.9249782325330734`*^9}, {3.924982277206662*^9, 3.9249822826627254`*^9}, {
   3.924984119555418*^9, 3.924984188059707*^9}, {3.9249842515178175`*^9, 
   3.9249842595504313`*^9}, {3.9249962927146983`*^9, 3.924996307723775*^9}, {
   3.9249963612840385`*^9, 3.9249963924459476`*^9}, {3.925000892685141*^9, 
   3.925000893328727*^9}, {3.92504490135832*^9, 3.9250449284330363`*^9}, {
   3.9250449673875637`*^9, 3.9250449758119307`*^9}, {3.9250791522586627`*^9, 
   3.925079195789849*^9}, {3.9250854291990576`*^9, 3.925085432231074*^9}, {
   3.9250854882825875`*^9, 3.9250854928984375`*^9}, 3.925088898610729*^9, {
   3.9250889428903685`*^9, 3.925088960281953*^9}, {3.9250890251540365`*^9, 
   3.925089050822753*^9}, {3.9250890910193186`*^9, 3.9250891596548157`*^9}, {
   3.925091005832399*^9, 3.9250910114142427`*^9}, 3.925096355908513*^9, 
   3.925096765509925*^9, {3.9252378945092797`*^9, 3.9252379136393576`*^9}, {
   3.925237983383033*^9, 3.9252380138848124`*^9}, {3.9252380809198613`*^9, 
   3.925238100246089*^9}, {3.9252986705224295`*^9, 3.9252986727830257`*^9}, {
   3.9266406107984023`*^9, 3.926640621087923*^9}, {3.940528431292105*^9, 
   3.940528459521847*^9}, {3.940530294288344*^9, 3.940530297923109*^9}, {
   3.940530452186469*^9, 3.9405304557870593`*^9}, 3.9405307532901907`*^9, {
   3.940531605959983*^9, 3.9405316775058312`*^9}, {3.9405317196249666`*^9, 
   3.9405317486919994`*^9}, {3.940532404861066*^9, 3.940532431042117*^9}, 
   3.9405327128588514`*^9, {3.940533106518648*^9, 3.940533152336652*^9}, {
   3.940538897624999*^9, 3.940538927076124*^9}, {3.940538963108985*^9, 
   3.9405389662454853`*^9}, {3.940539380864385*^9, 3.9405394129692707`*^9}, {
   3.9405396273720856`*^9, 3.9405396275496993`*^9}, {3.9405409255402784`*^9, 
   3.940540926470807*^9}, 3.940541097071703*^9, {3.940541151549962*^9, 
   3.940541167646819*^9}, {3.940541212537676*^9, 3.940541212610927*^9}, {
   3.940541253170456*^9, 3.9405412600849895`*^9}, {3.9405543654948654`*^9, 
   3.9405543657791796`*^9}, 3.9405979767558804`*^9, 3.9406004659737186`*^9, {
   3.941047568860156*^9, 3.941047570744595*^9}, {3.9410715453788276`*^9, 
   3.941071563912344*^9}, 3.941071601960845*^9, {3.9410717007867413`*^9, 
   3.9410717227480345`*^9}, {3.9410717737944345`*^9, 3.9410717830225534`*^9}, 
   3.9410727651331797`*^9, {3.941073535503503*^9, 3.941073543536072*^9}, {
   3.9410736820391817`*^9, 3.941073756124875*^9}, {3.941077390682437*^9, 
   3.941077420374445*^9}, {3.941079407101467*^9, 3.9410794110125303`*^9}, 
   3.941079442916425*^9, {3.9410802857841883`*^9, 3.9410802884047437`*^9}, {
   3.941081141303666*^9, 3.941081145429713*^9}, {3.941127724501996*^9, 
   3.9411277402909203`*^9}, {3.9411287851278462`*^9, 3.941128824896742*^9}, {
   3.941131139075802*^9, 3.94113114917304*^9}, {3.9411314933280535`*^9, 
   3.9411314938397627`*^9}, {3.94115337449094*^9, 3.9411533855812016`*^9}, {
   3.9411641861653996`*^9, 3.9411642518372884`*^9}, {3.9411644230381775`*^9, 
   3.94116446827614*^9}, {3.941164589293578*^9, 3.9411648083637724`*^9}, {
   3.9411706049918203`*^9, 3.941170620564849*^9}, {3.9411707986206074`*^9, 
   3.9411708021250134`*^9}, {3.9411713062112827`*^9, 
   3.9411713152335243`*^9}, {3.941212906773197*^9, 3.94121291905258*^9}, {
   3.9412162146703043`*^9, 3.9412162158949575`*^9}, {3.9412163586252985`*^9, 
   3.9412163611856947`*^9}, {3.9412167543596535`*^9, 3.941216840173561*^9}, {
   3.941238976043369*^9, 3.9412389787686872`*^9}, {3.9412536553163233`*^9, 
   3.9412536554409924`*^9}, {3.9417167098651233`*^9, 
   3.9417167444853773`*^9}, {3.9417168194173703`*^9, 
   3.9417168337733955`*^9}, {3.945858751008237*^9, 3.9458587512647147`*^9}, {
   3.946984038219139*^9, 3.946984044725275*^9}, {3.946984109535268*^9, 
   3.9469841144157405`*^9}, {3.94698453689281*^9, 3.9469845443706727`*^9}, {
   3.946984628784498*^9, 3.9469846344574847`*^9}, {3.947005868044117*^9, 
   3.9470058848929143`*^9}, {3.947392154364025*^9, 3.947392154708332*^9}, {
   3.9494140461913843`*^9, 3.949414046257809*^9}, 3.9529849778803387`*^9, {
   3.9737311107872186`*^9, 3.9737311639102077`*^9}, {3.9737312295181284`*^9, 
   3.9737314260463877`*^9}, {3.973731457881822*^9, 3.973731668005868*^9}, {
   3.9738859136284523`*^9, 3.973885928079177*^9}, 
   3.9738867921069145`*^9},ExpressionUUID->"78502ec7-6974-45c9-a8b9-\
f8873999f31b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"===", "===", "==="}], "=", " ", 
    RowBox[{
     RowBox[{"DEFINE", " ", 
      RowBox[{"FUNCTION", ":", " ", 
       RowBox[{
        RowBox[{"BACKGROUND", " ", "SOLVER"}], " ", "===", "===", "==="}]}]}],
      "="}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "runBckgr", "]"}], "=", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Xi]\[CurlyPhi]", "->", "0"}], ",", "\[IndentingNewLine]", 
       RowBox[{"\[Xi]\[Chi]", "->", "0"}], ",", "\[IndentingNewLine]", 
       RowBox[{"V0", "->", 
        RowBox[{"8", " ", 
         SuperscriptBox["10", 
          RowBox[{"-", "11"}]]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"M", "->", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "/", "2"}], ")"}], " ", "Mp"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"A", "->", 
        RowBox[{"117", " ", 
         SuperscriptBox["10", 
          RowBox[{"-", "5"}]]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"\[CurlyPhi]b", "->", 
        RowBox[{"218812", " ", 
         SuperscriptBox["10", 
          RowBox[{"-", "5"}]], " ", "Mp"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"\[Sigma]b", "->", 
        RowBox[{"159", " ", 
         SuperscriptBox["10", 
          RowBox[{"-", "4"}]], " ", "Mp"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"m\[Chi]", "->", 
        RowBox[{
         SuperscriptBox["10", 
          RowBox[{"-", "7"}]], " ", "Mp"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"\[CurlyPhi]i", "->", 
        RowBox[{"35", "/", "10"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"\[Chi]i", "->", "1"}], ",", "\[IndentingNewLine]", 
       RowBox[{"d\[CurlyPhi]i", "->", "0"}], ",", "\[IndentingNewLine]", 
       RowBox[{"d\[Chi]i", "->", "0"}], ",", "\[IndentingNewLine]", 
       RowBox[{"\[ScriptCapitalN]x", "->", "2"}]}], "\[IndentingNewLine]", 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"runBckgr", "[", 
      RowBox[{"OptionsPattern", "[", "]"}], "]"}], ":=", 
     "\[IndentingNewLine]", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"\[ScriptCapitalN]x", "=", 
         RowBox[{"OptionValue", "[", "\[ScriptCapitalN]x", "]"}]}], 
        "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"allParams", "=", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"\[Xi]\[CurlyPhi]", "->", 
            RowBox[{"OptionValue", "[", "\[Xi]\[CurlyPhi]", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"\[Xi]\[Chi]", "->", 
            RowBox[{"OptionValue", "[", "\[Xi]\[Chi]", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"V0", "->", 
            RowBox[{"OptionValue", "[", "V0", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"M", "->", 
            RowBox[{"OptionValue", "[", "M", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"A", "->", 
            RowBox[{"OptionValue", "[", "A", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"\[CurlyPhi]b", "->", 
            RowBox[{"OptionValue", "[", "\[CurlyPhi]b", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"\[Sigma]b", "->", 
            RowBox[{"OptionValue", "[", "\[Sigma]b", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"m\[Chi]", "->", 
            RowBox[{"OptionValue", "[", "m\[Chi]", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"\[CurlyPhi]i", "->", 
            RowBox[{"OptionValue", "[", "\[CurlyPhi]i", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"\[Chi]i", "->", 
            RowBox[{"OptionValue", "[", "\[Chi]i", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"d\[CurlyPhi]i", "->", 
            RowBox[{"OptionValue", "[", "d\[CurlyPhi]i", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"d\[Chi]i", "->", 
            RowBox[{"OptionValue", "[", "d\[Chi]i", "]"}]}]}], 
          "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"Clear", "[", 
         RowBox[{"(*", 
          RowBox[{"m\[Chi]", ","}], "*)"}], "Nend", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Clear", "[", 
         RowBox[{
         "\[Phi]1", ",", "\[Phi]2", ",", "\[Pi]1", ",", "\[Pi]2", ",", 
          "\[Phi]a", ",", "\[Pi]a", ",", "\[Sigma]", ",", "V", ",", 
          "\[Epsilon]", ",", "H", ",", "bgSol"}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"\[Phi]initial", "=", 
         RowBox[{"{", 
          RowBox[{"\[CurlyPhi]i", ",", "\[Chi]i"}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Pi]initial", "=", 
         RowBox[{"{", 
          RowBox[{"d\[CurlyPhi]i", ",", "d\[Chi]i"}], "}"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"NendReal", ":=", 
         RowBox[{"Nend", "+", "NendSkip"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"--", 
            RowBox[{"-", " ", "MODEL"}]}], " ", 
           RowBox[{"DEFINITION", "         ", "--"}]}], "-"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"\[ScriptCapitalN]", "=", "2"}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[CurlyPhi]", "=", 
         RowBox[{"\[Phi]1", "[", "Ne", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Chi]", "=", 
         RowBox[{"\[Phi]2", "[", "Ne", "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Coupling", " ", "to", " ", 
          RowBox[{"gravity", ":"}]}], "*)"}], " ", "\[IndentingNewLine]", 
        RowBox[{"f", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "/", "2"}], ")"}], 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["Mp", "2"], "+", 
            RowBox[{"\[Xi]\[CurlyPhi]", " ", 
             SuperscriptBox["\[CurlyPhi]", "2"]}], "+", 
            RowBox[{"\[Xi]\[Chi]", " ", 
             SuperscriptBox["\[Chi]", "2"]}]}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dfd\[CurlyPhi]", "=", 
         RowBox[{"\[Xi]\[CurlyPhi]", " ", "\[CurlyPhi]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dfd\[Chi]", "=", 
         RowBox[{"\[Xi]\[Chi]", " ", "\[Chi]"}]}], ";", "\[IndentingNewLine]",
         "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Fields", " ", 
          RowBox[{"potential", ":"}]}], "*)"}], " ", 
        RowBox[{"(*", 
         RowBox[{"PBH", " ", "potential", " ", 
          RowBox[{"from", " ", "[", "1911.00057", "]"}], " ", 
          RowBox[{"eq", ".", " ", 
           RowBox[{"(", "3.4", ")"}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"VPBH", "=", 
         RowBox[{"V0", " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["\[CurlyPhi]", "2"], "/", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["\[CurlyPhi]", "2"], "+", 
              SuperscriptBox["M", "2"]}], ")"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"A", " ", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"(", 
                 RowBox[{"1", "/", "2"}], ")"}]}], 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"\[CurlyPhi]", "-", "\[CurlyPhi]b"}], ")"}], "2"], 
                 "/", 
                 SuperscriptBox["\[Sigma]b", "2"]}], ")"}]}], "]"}]}]}], 
           ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"V\[Chi]", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "/", "2"}], ")"}], 
          SuperscriptBox["m\[Chi]", "2"], " ", 
          SuperscriptBox["\[Chi]", "2"]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"V", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["Mp", "4"], "/", 
            RowBox[{"(", 
             RowBox[{"4", " ", 
              SuperscriptBox["f", "2"]}], ")"}]}], ")"}], 
          RowBox[{"(", 
           RowBox[{"VPBH", "+", "V\[Chi]"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Field", "-", 
          RowBox[{"space", " ", 
           RowBox[{"metric", ":"}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"\[Gamma]", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["Mp", "2"], "/", 
            RowBox[{"(", 
             RowBox[{"2", "f"}], ")"}]}], ")"}], 
          RowBox[{"(", GridBox[{
             {
              RowBox[{"1", "+", 
               RowBox[{"3", " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["dfd\[CurlyPhi]", "2"], "/", "f"}], 
                 ")"}]}]}], 
              RowBox[{"3", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"dfd\[CurlyPhi]", " ", "dfd\[Chi]"}], ")"}], "/", 
                 "f"}], ")"}]}]},
             {
              RowBox[{"3", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"dfd\[CurlyPhi]", " ", "dfd\[Chi]"}], ")"}], "/", 
                 "f"}], ")"}]}], 
              RowBox[{"1", "+", 
               RowBox[{"3", " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["dfd\[Chi]", "2"], "/", "f"}], ")"}]}]}]}
            }], ")"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"--", 
           RowBox[{"-", " ", 
            RowBox[{"BACKGROUND", "               ", "--"}]}]}], "-"}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"\[Phi]a", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Symbol", "[", 
             RowBox[{"\"\<\[Phi]\>\"", "<>", 
              RowBox[{"ToString", "[", "a", "]"}]}], "]"}], "[", "Ne", "]"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"a", ",", "\[ScriptCapitalN]"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Pi]a", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Symbol", "[", 
             RowBox[{"\"\<\[Pi]\>\"", "<>", 
              RowBox[{"ToString", "[", "a", "]"}]}], "]"}], "[", "Ne", "]"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"a", ",", "\[ScriptCapitalN]"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Sigma]", "=", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Pi]a", "[", 
              RowBox[{"[", "a", "]"}], "]"}], " ", 
             RowBox[{"\[Gamma]", "[", 
              RowBox[{"[", 
               RowBox[{"a", ",", "b"}], "]"}], "]"}], " ", 
             RowBox[{"\[Pi]a", "[", 
              RowBox[{"[", "b", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"a", ",", "1", ",", "\[ScriptCapitalN]"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"b", ",", "1", ",", "\[ScriptCapitalN]"}], "}"}]}], 
           "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"\[Gamma]inv", "=", 
         RowBox[{"Inverse", "[", "\[Gamma]", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[CapitalGamma]", "=", 
         RowBox[{"Simplify", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", "2"}], ")"}], " ", 
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"\[Gamma]inv", "[", 
                 RowBox[{"[", 
                  RowBox[{"a", ",", "f"}], "]"}], "]"}], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"D", "[", 
                   RowBox[{
                    RowBox[{"\[Gamma]", "[", 
                    RowBox[{"[", 
                    RowBox[{"f", ",", "c"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Phi]a", "[", 
                    RowBox[{"[", "b", "]"}], "]"}]}], "]"}], "+", 
                  RowBox[{"D", "[", 
                   RowBox[{
                    RowBox[{"\[Gamma]", "[", 
                    RowBox[{"[", 
                    RowBox[{"b", ",", "f"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Phi]a", "[", 
                    RowBox[{"[", "c", "]"}], "]"}]}], "]"}], "-", 
                  RowBox[{"D", "[", 
                   RowBox[{
                    RowBox[{"\[Gamma]", "[", 
                    RowBox[{"[", 
                    RowBox[{"b", ",", "c"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Phi]a", "[", 
                    RowBox[{"[", "f", "]"}], "]"}]}], "]"}]}], ")"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"f", ",", "\[ScriptCapitalN]"}], "}"}]}], "]"}]}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"a", ",", "\[ScriptCapitalN]"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"b", ",", "\[ScriptCapitalN]"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"c", ",", "\[ScriptCapitalN]"}], "}"}]}], "]"}], "]"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"DdN", "[", "X_", "]"}], ":=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"X", "[", 
               RowBox[{"[", "a", "]"}], "]"}], ",", "Ne"}], "]"}], "+", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"\[CapitalGamma]", "[", 
                RowBox[{"[", 
                 RowBox[{"a", ",", "b", ",", "c"}], "]"}], "]"}], " ", 
               RowBox[{"X", "[", 
                RowBox[{"[", "b", "]"}], "]"}], " ", 
               RowBox[{"\[Pi]a", "[", 
                RowBox[{"[", "c", "]"}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"b", ",", "\[ScriptCapitalN]"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"c", ",", "\[ScriptCapitalN]"}], "}"}]}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"a", ",", "\[ScriptCapitalN]"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"\[Epsilon]", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "/", "2"}], ")"}], 
          SuperscriptBox["\[Sigma]", "2"]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"H", "=", 
         RowBox[{"\[Sqrt]", 
          RowBox[{"(", 
           RowBox[{"V", "/", 
            RowBox[{"(", 
             RowBox[{"3", "-", "\[Epsilon]"}], ")"}]}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"covVa", "=", 
         RowBox[{"D", "[", 
          RowBox[{"V", ",", 
           RowBox[{"{", "\[Phi]a", "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Va", "=", 
         RowBox[{"\[Gamma]inv", ".", "covVa"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Equations", " ", "of", " ", "Motion"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"\[Phi]eq", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"\[Phi]a", "[", 
               RowBox[{"[", "a", "]"}], "]"}], ",", "Ne"}], "]"}], "\[Equal]", 
            RowBox[{"\[Pi]a", "[", 
             RowBox[{"[", "a", "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"a", ",", "\[ScriptCapitalN]"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Pi]eq", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"DdN", "[", "\[Pi]a", "]"}], "[", 
             RowBox[{"[", "a", "]"}], "]"}], "\[Equal]", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"\[Epsilon]", "-", "3"}], ")"}], 
              RowBox[{"\[Pi]a", "[", 
               RowBox[{"[", "a", "]"}], "]"}]}], "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "/", 
                SuperscriptBox["H", "2"]}], ")"}], " ", 
              RowBox[{"Va", "[", 
               RowBox[{"[", "a", "]"}], "]"}]}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"a", ",", "\[ScriptCapitalN]"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Phi]IC", "=", 
         RowBox[{"Thread", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Phi]a", " ", "/.", " ", 
             RowBox[{"Ne", "\[Rule]", "Ninitial"}]}], ")"}], "\[Equal]", 
           "\[Phi]initial"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Pi]IC", "=", 
         RowBox[{"Thread", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Pi]a", " ", "/.", " ", 
             RowBox[{"Ne", "\[Rule]", "Ninitial"}]}], ")"}], "\[Equal]", 
           "\[Pi]initial"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"bgeqs", "=", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
           "\[Phi]eq", ",", "\[Pi]eq", ",", "\[Phi]IC", ",", "\[Pi]IC"}], 
           "]"}], "/.", "allParams"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Phi]params", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Symbol", "[", 
            RowBox[{"\"\<\[Phi]\>\"", "<>", 
             RowBox[{"ToString", "[", "a", "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"a", ",", "\[ScriptCapitalN]"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Pi]params", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Symbol", "[", 
            RowBox[{"\"\<\[Pi]\>\"", "<>", 
             RowBox[{"ToString", "[", "a", "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"a", ",", "\[ScriptCapitalN]"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"bgparams", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"\[Phi]params", ",", "\[Pi]params"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Nendsilly", "=", "300"}], ";", " ", 
        RowBox[{"(*", 
         RowBox[{
         "Absurdly", " ", "large", " ", "Nend", " ", "as", " ", "a", " ", 
          "test", " ", "result"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"endevent", "=", 
         RowBox[{
          RowBox[{"\[Epsilon]", "-", "1"}], "/.", "allParams"}]}], ";", " ", 
        RowBox[{"(*", 
         RowBox[{
         "Event", " ", "for", " ", "which", " ", "inflation", " ", "ends"}], 
         "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"bgSol", "=", 
         RowBox[{
          RowBox[{"NDSolve", "[", 
           RowBox[{"bgeqs", ",", "bgparams", ",", 
            RowBox[{"{", 
             RowBox[{"Ne", ",", "Ninitial", ",", "Nendsilly"}], "}"}], ",", 
            RowBox[{"Method", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"\"\<EventLocator\>\"", ",", 
               RowBox[{"\"\<Event\>\"", "\[Rule]", 
                RowBox[{"{", "endevent", "}"}]}], ",", 
               RowBox[{"\"\<EventCondition\>\"", "->", 
                RowBox[{"(", 
                 RowBox[{"Ne", ">=", "5"}], ")"}]}]}], "}"}]}], ",", 
            RowBox[{"PrecisionGoal", "\[Rule]", "bgPrecGoal"}], ",", 
            RowBox[{"WorkingPrecision", "\[Rule]", "bgWorkPrec"}], ",", 
            RowBox[{"AccuracyGoal", "->", "bgAccGoal"}], ",", 
            RowBox[{"MaxSteps", "\[Rule]", "\[Infinity]"}]}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"Nend", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"InterpolatingFunctionDomain", "[", 
            RowBox[{"\[Phi]1", "/.", " ", "bgSol"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "]"}], "]"}], "-", "NendSkip"}]}], ";", 
        " ", 
        RowBox[{"(*", " ", 
         RowBox[{
         "added", " ", "NendSkip", " ", "to", " ", "avoid", " ", "numerical", 
          " ", "problems", " ", "in", " ", "P", 
          RowBox[{"(", "k", ")"}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"NeHXii", "==", "1"}], ",", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<Nend=\>\"", ",", "Nend"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Sanity", " ", 
          RowBox[{"checks", ":"}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Nend", "<", 
           RowBox[{"Nstar", "+", "5"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"Style", "[", 
             RowBox[{
             "\"\<PROBLEM: Not enough e-folds of inflation! Evaluation \
aborted.\>\"", ",", "14", ",", "Red"}], "]"}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"FrontEndExecute", "[", 
            RowBox[{"FrontEndToken", "[", "\"\<EvaluatorAbort\>\"", "]"}], 
            "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Nend", "\[Equal]", "Nendsilly"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"Style", "[", 
             RowBox[{
             "\"\<PROBLEM: Inflation does not end \
(Nend\[GreaterEqual]Nendsilly)! Evaluation aborted.\>\"", ",", "14", ",", 
              "Red"}], "]"}], "]"}], ";", 
           RowBox[{"FrontEndExecute", "[", 
            RowBox[{"FrontEndToken", "[", "\"\<EvaluatorAbort\>\"", "]"}], 
            "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"aH", "=", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"(", 
            RowBox[{"Ne", "-", "Npivot"}], ")"}]], " ", "H"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Slow", "-", 
          RowBox[{"Roll", " ", "Power", " ", "Spectrum"}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[ScriptCapitalQ]\[ScriptCapitalR]k", "[", "N_", "]"}], ":=", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", 
             RowBox[{"(", 
              RowBox[{"8", 
               SuperscriptBox["\[Pi]", "2"]}], ")"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["H", "2"], "/", "\[Epsilon]"}], ")"}]}], "/.", 
          RowBox[{"Ne", "->", "N"}]}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Density", ",", " ", "Pressure", ",", " ", 
          RowBox[{"and", " ", "EoS"}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"\[Rho]", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "2"}], ")"}], 
           SuperscriptBox["H", "2"], " ", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Pi]a", "[", 
               RowBox[{"[", "a", "]"}], "]"}], " ", 
              RowBox[{"\[Gamma]", "[", 
               RowBox[{"[", 
                RowBox[{"a", ",", "b"}], "]"}], "]"}], " ", 
              RowBox[{"\[Pi]a", "[", 
               RowBox[{"[", "b", "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"a", ",", "1", ",", "2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"b", ",", "1", ",", "2"}], "}"}]}], "]"}]}], "+", 
          "V"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"p", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "2"}], ")"}], 
           SuperscriptBox["H", "2"], " ", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Pi]a", "[", 
               RowBox[{"[", "a", "]"}], "]"}], " ", 
              RowBox[{"\[Gamma]", "[", 
               RowBox[{"[", 
                RowBox[{"a", ",", "b"}], "]"}], "]"}], " ", 
              RowBox[{"\[Pi]a", "[", 
               RowBox[{"[", "b", "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"a", ",", "1", ",", "2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"b", ",", "1", ",", "2"}], "}"}]}], "]"}]}], "-", 
          "V"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Omega]EoS", "=", 
         RowBox[{"p", "/", "\[Rho]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"--", 
           RowBox[{"-", " ", 
            RowBox[{"PERTURBATIONS", "            ", "--"}]}]}], "-"}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"det\[Gamma]", "=", 
         RowBox[{"SetPrecision", "[", 
          RowBox[{
           RowBox[{"Det", "[", "\[Gamma]", "]"}], ",", "bgWorkPrec"}], 
          "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"eTa", "=", 
         RowBox[{"\[Pi]a", "/", "\[Sigma]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"eNa", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "/", 
            RowBox[{"(", 
             RowBox[{"\[Sigma]", " ", 
              RowBox[{"Sqrt", "[", "det\[Gamma]", "]"}]}], ")"}]}], ")"}], 
          " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               RowBox[{"\[Gamma]", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "2"}], "]"}], "]"}]}], " ", 
              RowBox[{"\[Pi]1", "[", "Ne", "]"}]}], "-", 
             RowBox[{
              RowBox[{"\[Gamma]", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", 
              RowBox[{"\[Pi]2", "[", "Ne", "]"}]}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Gamma]", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
              RowBox[{"\[Pi]1", "[", "Ne", "]"}]}], "+", 
             RowBox[{
              RowBox[{"\[Gamma]", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", 
              RowBox[{"\[Pi]2", "[", "Ne", "]"}]}]}]}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"V\[Phi]", "=", 
         RowBox[{"eTa", ".", "covVa"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"VN", "=", 
         RowBox[{"eNa", ".", "covVa"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"DH", "=", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{"1", "/", "2"}], ")"}]}], " ", "H", " ", 
          SuperscriptBox["\[Sigma]", "2"]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"D\[Sigma]", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "3"}], " ", "\[Sigma]"}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", 
             SuperscriptBox["H", "2"]}], ")"}], " ", "V\[Phi]"}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"DH", "/", "H"}], ")"}], " ", "\[Sigma]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"DDH", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"1", "/", "2"}], ")"}]}], " ", "DH", " ", 
           SuperscriptBox["\[Sigma]", "2"]}], "-", 
          RowBox[{"H", " ", "\[Sigma]", " ", "D\[Sigma]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"D\[Pi]a", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"\[Epsilon]", "-", "3"}], ")"}], 
             RowBox[{"\[Pi]a", "[", 
              RowBox[{"[", "a", "]"}], "]"}]}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", 
               SuperscriptBox["H", "2"]}], ")"}], " ", 
             RowBox[{"Va", "[", 
              RowBox[{"[", "a", "]"}], "]"}]}], "-", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"\[CapitalGamma]", "[", 
                RowBox[{"[", 
                 RowBox[{"a", ",", "b", ",", "c"}], "]"}], "]"}], " ", 
               RowBox[{"\[Pi]a", "[", 
                RowBox[{"[", "b", "]"}], "]"}], " ", 
               RowBox[{"\[Pi]a", "[", 
                RowBox[{"[", "c", "]"}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"b", ",", "1", ",", "\[ScriptCapitalN]"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"c", ",", "1", ",", "\[ScriptCapitalN]"}], "}"}]}], 
             "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"a", ",", "1", ",", "\[ScriptCapitalN]"}], "}"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"DeTa", "=", 
         RowBox[{
          RowBox[{"D\[Pi]a", "/", "\[Sigma]"}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Pi]a", " ", "D\[Sigma]"}], ")"}], "/", 
           SuperscriptBox["\[Sigma]", "2"]}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"DeNa", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", 
             RowBox[{"(", 
              RowBox[{"\[Sigma]", " ", 
               RowBox[{"Sqrt", "[", "det\[Gamma]", "]"}]}], ")"}]}], ")"}], 
           " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{"\[Gamma]", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", "Ne"}], 
                 "]"}]}], " ", 
               RowBox[{"\[Pi]a", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"\[Gamma]", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", 
               RowBox[{"D\[Pi]a", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{"\[Gamma]", "[", 
                  RowBox[{"[", 
                   RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", "Ne"}], "]"}], 
               " ", 
               RowBox[{"\[Pi]a", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"\[Gamma]", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", 
               RowBox[{"D\[Pi]a", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{"\[Gamma]", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "Ne"}], "]"}], 
               " ", 
               RowBox[{"\[Pi]a", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "+", 
              RowBox[{
               RowBox[{"\[Gamma]", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
               RowBox[{"D\[Pi]a", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "+", 
              RowBox[{
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{"\[Gamma]", "[", 
                  RowBox[{"[", 
                   RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", "Ne"}], "]"}], 
               " ", 
               RowBox[{"\[Pi]a", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "+", 
              RowBox[{
               RowBox[{"\[Gamma]", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", 
               RowBox[{"D\[Pi]a", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}]}]}], "}"}]}], "-", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"D\[Sigma]", " ", 
                RowBox[{"Sqrt", "[", "det\[Gamma]", "]"}]}], "+", 
               RowBox[{"\[Sigma]", " ", 
                RowBox[{"(", 
                 RowBox[{"1", "/", 
                  RowBox[{"(", 
                   RowBox[{"2", " ", 
                    RowBox[{"Sqrt", "[", "det\[Gamma]", "]"}]}], ")"}]}], 
                 ")"}], " ", 
                RowBox[{"D", "[", 
                 RowBox[{"det\[Gamma]", ",", "Ne"}], "]"}]}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["\[Sigma]", "2"], " ", "det\[Gamma]"}], ")"}]}],
             ")"}], " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                RowBox[{"\[Gamma]", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "2"}], "]"}], "]"}]}], " ", 
               RowBox[{"\[Pi]a", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"\[Gamma]", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", 
               RowBox[{"\[Pi]a", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"\[Gamma]", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
               RowBox[{"\[Pi]a", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "+", 
              RowBox[{
               RowBox[{"\[Gamma]", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", 
               RowBox[{"\[Pi]a", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}]}]}], "}"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"DV\[Phi]", "=", 
         RowBox[{
          RowBox[{"DeTa", ".", "covVa"}], "+", 
          RowBox[{"eTa", ".", 
           RowBox[{"D", "[", 
            RowBox[{"covVa", ",", "Ne"}], "]"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"DVN", "=", 
         RowBox[{
          RowBox[{"DeNa", ".", "covVa"}], "+", 
          RowBox[{"eNa", ".", 
           RowBox[{"D", "[", 
            RowBox[{"covVa", ",", "Ne"}], "]"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"DD\[Sigma]", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "3"}], " ", "D\[Sigma]"}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", 
             SuperscriptBox["H", "2"]}], ")"}], " ", "DV\[Phi]"}], "+", 
          RowBox[{"V\[Phi]", " ", 
           RowBox[{"(", 
            RowBox[{"2", "/", 
             SuperscriptBox["H", "3"]}], ")"}], " ", "DH"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"3", "/", "2"}], ")"}], " ", 
           SuperscriptBox["\[Sigma]", "2"], " ", "D\[Sigma]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Eta]T", "=", 
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"DH", " ", "\[Sigma]"}], "+", 
              RowBox[{"H", " ", "D\[Sigma]"}]}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{"H", " ", "\[Sigma]"}], ")"}]}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Eta]N", "=", 
         RowBox[{"VN", "/", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["H", "2"], " ", "\[Sigma]"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Eta]BF", "=", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{"D\[Sigma]", "/", "\[Sigma]"}], ")"}]}]}], ";", " ", 
        RowBox[{"(*", 
         RowBox[{
         "also", " ", "known", " ", "in", " ", "literature", " ", "as", " ", 
          SubscriptBox["\[Epsilon]", "2"]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"\[Eta]", "=", 
         RowBox[{
          SuperscriptBox["\[Sigma]", "2"], "-", 
          RowBox[{"D\[Sigma]", "/", "\[Sigma]"}]}]}], ";", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{"Dave", "'"}], "s", " ", "version", " ", "of", " ", 
           "\[Eta]"}], "=", 
          RowBox[{
           RowBox[{"2", "\[Epsilon]"}], "-", 
           RowBox[{
            SubscriptBox["\[Epsilon]", "2"], "/", "2"}]}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"D\[Eta]N", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "/", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["\[Sigma]", "2"], " ", 
              SuperscriptBox["H", "4"]}], ")"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"DVN", " ", 
             SuperscriptBox["H", "2"], " ", "\[Sigma]"}], "-", 
            RowBox[{"2", " ", "H", " ", "DH", " ", "VN", " ", "\[Sigma]"}], 
            "-", 
            RowBox[{
             SuperscriptBox["H", "2"], "D\[Sigma]", " ", "VN"}]}], ")"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"\[Xi]T", "=", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{"1", "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"H", " ", "DH", " ", "\[Sigma]"}], "+", 
               RowBox[{
                SuperscriptBox["H", "2"], " ", "D\[Sigma]"}]}], ")"}]}], 
            ")"}]}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["DH", "2"], "+", 
               RowBox[{"H", " ", "DDH"}]}], ")"}], " ", "\[Sigma]"}], "+", 
            RowBox[{"3", " ", "H", " ", "DH", " ", "D\[Sigma]"}], "+", 
            RowBox[{
             SuperscriptBox["H", "2"], " ", "DD\[Sigma]"}]}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Xi]N", "=", 
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{"D\[Eta]N", "/", "\[Eta]N"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"VNN", "=", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"eNa", "[", 
             RowBox[{"[", "a", "]"}], "]"}], " ", 
            RowBox[{"eNa", "[", 
             RowBox[{"[", "b", "]"}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{"covVa", "[", 
                 RowBox[{"[", "a", "]"}], "]"}], ",", 
                RowBox[{"\[Phi]a", "[", 
                 RowBox[{"[", "b", "]"}], "]"}]}], "]"}], "-", 
              RowBox[{"Sum", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"\[CapitalGamma]", "[", 
                  RowBox[{"[", 
                   RowBox[{"c", ",", "a", ",", "b"}], "]"}], "]"}], " ", 
                 RowBox[{"covVa", "[", 
                  RowBox[{"[", "c", "]"}], "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"c", ",", "\[ScriptCapitalN]"}], "}"}]}], "]"}]}], 
             ")"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"a", ",", "\[ScriptCapitalN]"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"b", ",", "\[ScriptCapitalN]"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"V\[Phi]\[Phi]", "=", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"eTa", "[", 
             RowBox[{"[", "a", "]"}], "]"}], " ", 
            RowBox[{"eTa", "[", 
             RowBox[{"[", "b", "]"}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{"covVa", "[", 
                 RowBox[{"[", "a", "]"}], "]"}], ",", 
                RowBox[{"\[Phi]a", "[", 
                 RowBox[{"[", "b", "]"}], "]"}]}], "]"}], "-", 
              RowBox[{"Sum", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"\[CapitalGamma]", "[", 
                  RowBox[{"[", 
                   RowBox[{"c", ",", "a", ",", "b"}], "]"}], "]"}], " ", 
                 RowBox[{"covVa", "[", 
                  RowBox[{"[", "c", "]"}], "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"c", ",", "\[ScriptCapitalN]"}], "}"}]}], "]"}]}], 
             ")"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"a", ",", "\[ScriptCapitalN]"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"b", ",", "\[ScriptCapitalN]"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[DoubleStruckCapitalR]ab", "=", 
         RowBox[{"Chop", "[", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{"\[CapitalGamma]", "[", 
                  RowBox[{"[", 
                   RowBox[{"c", ",", "a", ",", "b"}], "]"}], "]"}], ",", 
                 RowBox[{"\[Phi]a", "[", 
                  RowBox[{"[", "c", "]"}], "]"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"c", ",", "\[ScriptCapitalN]"}], "}"}]}], "]"}], "-", 
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{"\[CapitalGamma]", "[", 
                  RowBox[{"[", 
                   RowBox[{"c", ",", "b", ",", "c"}], "]"}], "]"}], ",", 
                 RowBox[{"\[Phi]a", "[", 
                  RowBox[{"[", "a", "]"}], "]"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"c", ",", "\[ScriptCapitalN]"}], "}"}]}], "]"}], "+", 
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"\[CapitalGamma]", "[", 
                 RowBox[{"[", 
                  RowBox[{"c", ",", "a", ",", "b"}], "]"}], "]"}], " ", 
                RowBox[{"\[CapitalGamma]", "[", 
                 RowBox[{"[", 
                  RowBox[{"d", ",", "c", ",", "d"}], "]"}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"c", ",", "\[ScriptCapitalN]"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"d", ",", "\[ScriptCapitalN]"}], "}"}]}], "]"}], "-", 
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"\[CapitalGamma]", "[", 
                 RowBox[{"[", 
                  RowBox[{"c", ",", "a", ",", "d"}], "]"}], "]"}], " ", 
                RowBox[{"\[CapitalGamma]", "[", 
                 RowBox[{"[", 
                  RowBox[{"d", ",", "c", ",", "b"}], "]"}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"c", ",", "\[ScriptCapitalN]"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"d", ",", "\[ScriptCapitalN]"}], "}"}]}], "]"}]}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"a", ",", "\[ScriptCapitalN]"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"b", ",", "\[ScriptCapitalN]"}], "}"}]}], "]"}], "]"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"\[DoubleStruckCapitalR]", "=", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Gamma]inv", "[", 
             RowBox[{"[", 
              RowBox[{"a", ",", "b"}], "]"}], "]"}], " ", 
            RowBox[{"\[DoubleStruckCapitalR]ab", "[", 
             RowBox[{"[", 
              RowBox[{"a", ",", "b"}], "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"a", ",", "\[ScriptCapitalN]"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"b", ",", "\[ScriptCapitalN]"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"M2vN", "=", 
         RowBox[{"VNN", "+", 
          RowBox[{
           SuperscriptBox["H", "2"], " ", "\[Epsilon]", " ", 
           "\[DoubleStruckCapitalR]"}]}]}], ";", " ", 
        RowBox[{"(*", 
         RowBox[{
         "effective", " ", "mass", " ", "squared", " ", "of", " ", "the", " ", 
          SuperscriptBox["v", "N"], " ", "isocurvature", " ", 
          RowBox[{"pert", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"mseff2", "=", 
           RowBox[{"M2vN", "+", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["H", "2"], 
               RowBox[{"(", " ", 
                RowBox[{"DD\[Sigma]", "/", "\[Sigma]"}], ")"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"H", " ", "DH"}], "+", 
                 RowBox[{"3", 
                  SuperscriptBox["H", "2"]}]}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{"D\[Sigma]", "/", "\[Sigma]"}], ")"}]}]}], ")"}]}]}], 
          ";"}], "*)"}], " ", "\[IndentingNewLine]", 
        RowBox[{"\[Mu]S", "=", 
         RowBox[{"M2vN", "-", "V\[Phi]\[Phi]", "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["H", "2"], " ", "\[Epsilon]", 
           RowBox[{"(", 
            RowBox[{"3", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"\[Sigma]", " ", "D\[Sigma]"}], ")"}], "/", 
              "\[Epsilon]"}], "-", "\[Epsilon]"}], ")"}]}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["\[Omega]", "2"]}]}]}], ";", " ", 
        RowBox[{"(*", 
         RowBox[{
         "effective", " ", "mass", " ", "squared", " ", "of", " ", "the", " ",
           "\[ScriptCapitalS]", " ", "isocurvature", " ", 
          RowBox[{"pert", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"\[CapitalOmega]TT", "=", 
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{"2", "+", 
            RowBox[{"2", " ", "\[Epsilon]"}], "-", 
            RowBox[{"3", " ", "\[Eta]T"}], "+", 
            RowBox[{"\[Eta]T", " ", "\[Xi]T"}], "-", 
            RowBox[{"4", " ", "\[Epsilon]", " ", "\[Eta]T"}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["\[Epsilon]", "2"]}], "-", 
            SuperscriptBox["\[Eta]N", "2"]}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[CapitalOmega]NN", "=", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{"2", "-", "\[Epsilon]"}], ")"}]}], "+", 
          RowBox[{"M2vN", "/", 
           SuperscriptBox["H", "2"]}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"\[CapitalOmega]TN", "=", 
           RowBox[{"\[CapitalOmega]NT", "=", 
            RowBox[{"\[Eta]N", " ", 
             RowBox[{"(", 
              RowBox[{"3", "+", "\[Epsilon]", "-", 
               RowBox[{"2", " ", "\[Eta]T"}], "-", "\[Xi]N"}], ")"}]}]}]}], 
          ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"AllTrue", "[", 
           RowBox[{
            RowBox[{"\[Eta]N", "/.", 
             RowBox[{"Ne", "->", 
              RowBox[{"Range", "[", 
               RowBox[{
                RowBox[{"1", "/", "10"}], ",", "Nend", ",", 
                RowBox[{"1", "/", "10"}]}], "]"}]}]}], ",", "PossibleZeroQ"}],
            "]"}], ",", 
          RowBox[{"\[CapitalOmega]TN", "=", 
           RowBox[{"\[CapitalOmega]NT", "=", "0"}]}], ",", 
          RowBox[{"\[CapitalOmega]TN", "=", 
           RowBox[{"\[CapitalOmega]NT", "=", 
            RowBox[{"\[Eta]N", " ", 
             RowBox[{"(", 
              RowBox[{"3", "+", "\[Epsilon]", "-", 
               RowBox[{"2", " ", "\[Eta]T"}], "-", "\[Xi]N"}], ")"}]}]}]}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"to", " ", "avoid", " ", 
          RowBox[{"1", "/", "0"}], " ", "when", " ", "no", " ", "turn", " ", 
          "present", " ", 
          RowBox[{"(", 
           RowBox[{"single", "-", 
            RowBox[{"field", " ", "limit"}]}], ")"}]}], "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Definition", " ", "of", " ", "turn", " ", "rate", " ", 
          RowBox[{"from", " ", "[", "2010.04179", "]"}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"\[Omega]", "=", 
         RowBox[{
          RowBox[{"Sqrt", "[", "det\[Gamma]", "]"}], " ", "H", " ", 
          RowBox[{"eTa", ".", 
           RowBox[{"LeviCivitaTensor", "[", "2", "]"}], ".", "DeTa"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"\[Omega]overH", "=", 
         RowBox[{
          RowBox[{"Sqrt", "[", "det\[Gamma]", "]"}], " ", 
          RowBox[{"eTa", ".", 
           RowBox[{"LeviCivitaTensor", "[", "2", "]"}], ".", "DeTa"}]}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"USR", " ", "Power", " ", "spectra"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[ScriptCapitalP]\[ScriptCapitalR]k", "[", 
          RowBox[{"k_", ",", "N_", ",", "pSol_"}], "]"}], ":=", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["k", "3"], "/", 
             RowBox[{"(", 
              RowBox[{"4", " ", 
               SuperscriptBox["\[Pi]", "2"], " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 SuperscriptBox["\[ExponentialE]", 
                  RowBox[{"Ne", "-", "Npivot"}]], ")"}], "2"], " ", 
               "\[Epsilon]"}], ")"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"Abs", "[", 
               RowBox[{
                RowBox[{"vT1", "[", "Ne", "]"}], "/.", " ", "pSol"}], "]"}], 
              "2"], "+", 
             SuperscriptBox[
              RowBox[{"Abs", "[", 
               RowBox[{
                RowBox[{"vT2", "[", "Ne", "]"}], "/.", " ", "pSol"}], "]"}], 
              "2"]}], ")"}]}], "/.", " ", 
          RowBox[{"Ne", "->", "N"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[ScriptCapitalP]\[ScriptCapitalS]k", "[", 
          RowBox[{"k_", ",", "N_", ",", "pSol_"}], "]"}], ":=", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["k", "3"], "/", 
             RowBox[{"(", 
              RowBox[{"4", " ", 
               SuperscriptBox["\[Pi]", "2"], " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 SuperscriptBox["\[ExponentialE]", 
                  RowBox[{"Ne", "-", "Npivot"}]], ")"}], "2"], " ", 
               "\[Epsilon]"}], ")"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"Abs", "[", 
               RowBox[{
                RowBox[{"vN1", "[", "Ne", "]"}], "/.", " ", "pSol"}], "]"}], 
              "2"], "+", 
             SuperscriptBox[
              RowBox[{"Abs", "[", 
               RowBox[{
                RowBox[{"vN2", "[", "Ne", "]"}], "/.", " ", "pSol"}], "]"}], 
              "2"]}], ")"}]}], "/.", " ", 
          RowBox[{"Ne", "->", "N"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[ScriptCapitalP]\[ScriptCapitalR]\[ScriptCapitalS]k", "[", 
          RowBox[{"k_", ",", "N_", ",", "pSol_"}], "]"}], ":=", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["k", "3"], "/", 
             RowBox[{"(", 
              RowBox[{"4", " ", 
               SuperscriptBox["\[Pi]", "2"], " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 SuperscriptBox["\[ExponentialE]", 
                  RowBox[{"Ne", "-", "Npivot"}]], ")"}], "2"], " ", 
               "\[Epsilon]"}], ")"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Re", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"vT1", "[", "Ne", "]"}], "/.", " ", "pSol"}], ")"}], 
               " ", 
               RowBox[{"Conjugate", "[", 
                RowBox[{
                 RowBox[{"vN1", "[", "Ne", "]"}], "/.", " ", "pSol"}], 
                "]"}]}], "]"}], "+", 
             RowBox[{"Re", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"vT2", "[", "Ne", "]"}], "/.", " ", "pSol"}], ")"}], 
               " ", 
               RowBox[{"Conjugate", "[", 
                RowBox[{
                 RowBox[{"vN2", "[", "Ne", "]"}], "/.", " ", "pSol"}], 
                "]"}]}], "]"}]}], ")"}]}], "/.", " ", 
          RowBox[{"Ne", "->", "N"}]}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Calculate", " ", "k"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"kx", "[", 
          RowBox[{"Nx_", ",", 
           RowBox[{"Npiv_", ":", "Npivot"}]}], "]"}], ":=", 
         RowBox[{
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"(", 
             RowBox[{"Nx", "-", "Npiv"}], ")"}]], " ", "H"}], "/.", 
          RowBox[{"Ne", "->", "Nx"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"kr", "[", 
          RowBox[{"Nx_", ",", 
           RowBox[{"Ncmb_", ":", 
            RowBox[{"NendReal", "-", "Nstar"}]}]}], "]"}], ":=", 
         RowBox[{
          RowBox[{"kx", "[", "Nx", "]"}], "/", 
          RowBox[{"kx", "[", "Ncmb", "]"}]}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Return", " ", "the", " ", "bgSol", " ", "and", " ", "Nend", " ", 
          RowBox[{"(", "??", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"{", 
            RowBox[{"allParams", ",", "bgSol"}], "}"}], "]"}], ",", "Nend"}], 
         "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"===", "===", "==="}], "=", " ", 
     RowBox[{
      RowBox[{"DEFINE", " ", 
       RowBox[{"FUNCTION", ":", " ", 
        RowBox[{
         RowBox[{"PERTURBATIONS", " ", "SOLVER"}], " ", "===", "===", 
         "==="}]}]}], "="}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "runPerts", "]"}], " ", "=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Xi]\[CurlyPhi]", "->", "0"}], ",", "\[IndentingNewLine]", 
       RowBox[{"\[Xi]\[Chi]", "->", "0"}], ",", "\[IndentingNewLine]", 
       RowBox[{"V0", "->", 
        RowBox[{"8", " ", 
         SuperscriptBox["10", 
          RowBox[{"-", "11"}]]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"M", "->", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "/", "2"}], ")"}], " ", "Mp"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"A", "->", 
        RowBox[{"117", " ", 
         SuperscriptBox["10", 
          RowBox[{"-", "5"}]]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"\[CurlyPhi]b", "->", 
        RowBox[{"218812", " ", 
         SuperscriptBox["10", 
          RowBox[{"-", "5"}]], " ", "Mp"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"\[Sigma]b", "->", 
        RowBox[{"159", " ", 
         SuperscriptBox["10", 
          RowBox[{"-", "4"}]], " ", "Mp"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"m\[Chi]", "->", 
        RowBox[{
         SuperscriptBox["10", 
          RowBox[{"-", "7"}]], " ", "Mp"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"\[CurlyPhi]i", "->", 
        RowBox[{"35", "/", "10"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"\[Chi]i", "->", "1"}], ",", "\[IndentingNewLine]", 
       RowBox[{"d\[CurlyPhi]i", "->", "0"}], ",", "\[IndentingNewLine]", 
       RowBox[{"d\[Chi]i", "->", "0"}], ",", "\[IndentingNewLine]", 
       RowBox[{"\[ScriptCapitalN]x", "->", "2"}], ",", "\[IndentingNewLine]", 
       RowBox[{"outfileName", "->", "None"}]}], "\[IndentingNewLine]", 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"runPerts", "[", 
     RowBox[{"OptionsPattern", "[", "]"}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"outfilename", "=", 
         RowBox[{"OptionValue", "[", "outfileName", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\[ScriptCapitalN]x", "=", 
         RowBox[{"OptionValue", "[", "\[ScriptCapitalN]x", "]"}]}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"\[Xi]\[CurlyPhi]", "=", 
         RowBox[{"OptionValue", "[", "\[Xi]\[CurlyPhi]", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Xi]\[Chi]", "=", 
         RowBox[{"OptionValue", "[", "\[Xi]\[Chi]", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"V0", "=", 
         RowBox[{"OptionValue", "[", "V0", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"M", "=", 
         RowBox[{"OptionValue", "[", "M", "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"A", "=", 
         RowBox[{"OptionValue", "[", "A", "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\[CurlyPhi]b", "=", 
         RowBox[{"OptionValue", "[", "\[CurlyPhi]b", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Sigma]b", "=", 
         RowBox[{"OptionValue", "[", "\[Sigma]b", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"m\[Chi]", "=", 
         RowBox[{"OptionValue", "[", "m\[Chi]", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\[CurlyPhi]i", "=", 
         RowBox[{"OptionValue", "[", "\[CurlyPhi]i", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Chi]i", "=", 
         RowBox[{"OptionValue", "[", "\[Chi]i", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"d\[CurlyPhi]i", "=", 
         RowBox[{"OptionValue", "[", "d\[CurlyPhi]i", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"d\[Chi]i", "=", 
         RowBox[{"OptionValue", "[", "d\[Chi]i", "]"}]}]}], 
       "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"DistributeDefinitions", "[", "runBckgr", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Clear", "[", "Nend", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"outfilename", "==", "None"}], ",", 
         RowBox[{"writeSols", "=", "False"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"\[Phi]initial", "=", 
        RowBox[{"{", 
         RowBox[{"\[CurlyPhi]i", ",", "\[Chi]i"}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Pi]initial", "=", 
        RowBox[{"{", 
         RowBox[{"d\[CurlyPhi]i", ",", "d\[Chi]i"}], "}"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"pertSol", "=", 
        RowBox[{"{", "}"}]}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{"Save", " ", "individual", " ", 
         RowBox[{"sol", ".", "s"}], " ", 
         RowBox[{"as", ":", " ", 
          RowBox[{"{", 
           RowBox[{
           "NeHX", ",", "ks", ",", "ksRatio", ",", "tmpPRk", ",", "tmpPSk", 
            ",", "tmpPRSk", ",", "tmpTime", ",", "tmpSol"}], "}"}]}]}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"PRkEnd", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"PSkEnd", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"PRSkEnd", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"SetSharedVariable", "[", 
        RowBox[{"pertSol", ",", "PRkEnd", ",", "PSkEnd", ",", "PRSkEnd"}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"NendReal", ":=", 
        RowBox[{"Nend", "+", "NendSkip"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Define", " ", "everything", " ", "inside", " ", "a", " ", 
         "ParallelDo", " ", "running", " ", "over", " ", "each", " ", "NeHX", 
         " ", 
         RowBox[{"value", ":"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"ParallelDo", "[", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Clear", " ", "all", " ", "variables", " ", "except", " ", "the", 
           " ", "ones", " ", "defined", " ", "above"}], " ", "+", " ", 
          RowBox[{"the", " ", "iteration", " ", "index"}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Clear", "@@", 
           RowBox[{"DeleteCases", "[", 
            RowBox[{
             RowBox[{"Names", "@", "\"\<`*\>\""}], ",", "\[IndentingNewLine]", 
             RowBox[{
             "\"\<runBckgr\>\"", "|", "\[IndentingNewLine]", 
              "\"\<allParams\>\"", "|", "\[IndentingNewLine]", "\"\<Mp\>\"", 
              "|", "\[IndentingNewLine]", "\"\<\[Xi]\[CurlyPhi]\>\"", "|", 
              "\[IndentingNewLine]", "\"\<\[Xi]\[Chi]\>\"", "|", 
              "\[IndentingNewLine]", "\"\<V0\>\"", "|", 
              "\[IndentingNewLine]", "\"\<M\>\"", "|", "\[IndentingNewLine]", 
              "\"\<A\>\"", "|", "\[IndentingNewLine]", "\"\<\[CurlyPhi]b\>\"",
               "|", "\[IndentingNewLine]", "\"\<\[Sigma]b\>\"", "|", 
              "\[IndentingNewLine]", "\"\<m\[Chi]\>\"", "|", 
              "\[IndentingNewLine]", "\"\<RV\>\"", "|", 
              "\[IndentingNewLine]", "\"\<\[Chi]i\>\"", "|", 
              "\[IndentingNewLine]", "\"\<\[ScriptCapitalN]x\>\"", "|", 
              "\[IndentingNewLine]", "\"\<\[Phi]initial\>\"", "|", 
              "\[IndentingNewLine]", "\"\<\[Pi]initial\>\"", "|", 
              "\[IndentingNewLine]", "\"\<saveSols\>\"", "|", 
              "\[IndentingNewLine]", "\"\<writeSols\>\"", "|", 
              "\[IndentingNewLine]", "\"\<keepInSol\>\"", "|", 
              "\[IndentingNewLine]", "\"\<outfilename\>\"", "|", 
              "\[IndentingNewLine]", "\"\<writeObservables\>\"", "|", 
              "\[IndentingNewLine]", "\"\<NeHX\>\"", "|", 
              "\[IndentingNewLine]", "\"\<Npivot\>\"", "|", 
              "\[IndentingNewLine]", "\"\<workPrecs\>\"", "|", 
              "\[IndentingNewLine]", "\"\<precGoals\>\"", "|", 
              "\[IndentingNewLine]", "\"\<accGoals\>\"", "|", 
              "\[IndentingNewLine]", "\"\<bgWorkPrec\>\"", "|", 
              "\[IndentingNewLine]", "\"\<bgPrecGoal\>\"", "|", 
              "\[IndentingNewLine]", "\"\<bgAccGoal\>\"", "|", 
              "\[IndentingNewLine]", "\"\<NendSkip\>\"", "|", 
              "\[IndentingNewLine]", "\"\<Nstar\>\"", " ", "|", 
              "\[IndentingNewLine]", "\"\<NendReal\>\"", " ", "|", 
              "\[IndentingNewLine]", "\"\<Ninitial\>\"", " ", "|", 
              "\[IndentingNewLine]", "\"\<pertSol\>\"", "|", 
              "\[IndentingNewLine]", "\"\<PRkEnd\>\"", "|", 
              "\[IndentingNewLine]", "\"\<PSkEnd\>\"", "|", 
              "\[IndentingNewLine]", "\"\<PRSkEnd\>\"", "|", 
              "\[IndentingNewLine]", "\"\<NeHXii\>\"", "|", 
              "\[IndentingNewLine]", "\"\<allSols\>\""}]}], 
            "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}], " ", 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"--", 
              RowBox[{"-", " ", "MODEL"}]}], " ", 
             RowBox[{"DEFINITION", "         ", "--"}]}], "-"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}], " ", 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"\[ScriptCapitalN]", "=", "2"}], ";", "\[IndentingNewLine]", 
          RowBox[{"\[CurlyPhi]", "=", 
           RowBox[{"\[Phi]1", "[", "Ne", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"\[Chi]", "=", 
           RowBox[{"\[Phi]2", "[", "Ne", "]"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Coupling", " ", "to", " ", 
            RowBox[{"gravity", ":"}]}], "*)"}], " ", "\[IndentingNewLine]", 
          RowBox[{"f", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "/", "2"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["Mp", "2"], "+", 
              RowBox[{"\[Xi]\[CurlyPhi]", " ", 
               SuperscriptBox["\[CurlyPhi]", "2"]}], "+", 
              RowBox[{"\[Xi]\[Chi]", " ", 
               SuperscriptBox["\[Chi]", "2"]}]}], ")"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"dfd\[CurlyPhi]", "=", 
           RowBox[{"\[Xi]\[CurlyPhi]", " ", "\[CurlyPhi]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"dfd\[Chi]", "=", 
           RowBox[{"\[Xi]\[Chi]", " ", "\[Chi]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Fields", " ", 
            RowBox[{"potential", ":"}]}], "*)"}], " ", 
          RowBox[{"(*", 
           RowBox[{"PBH", " ", "potential", " ", 
            RowBox[{"from", " ", "[", "1911.00057", "]"}], " ", 
            RowBox[{"eq", ".", " ", 
             RowBox[{"(", "3.4", ")"}]}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"VPBH", "=", 
           RowBox[{"V0", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["\[CurlyPhi]", "2"], "/", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["\[CurlyPhi]", "2"], "+", 
                SuperscriptBox["M", "2"]}], ")"}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"A", " ", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"(", 
                   RowBox[{"1", "/", "2"}], ")"}]}], 
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"\[CurlyPhi]", "-", "\[CurlyPhi]b"}], ")"}], "2"],
                    "/", 
                   SuperscriptBox["\[Sigma]b", "2"]}], ")"}]}], "]"}]}]}], 
             ")"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"V\[Chi]", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "/", "2"}], ")"}], 
            SuperscriptBox["m\[Chi]", "2"], " ", 
            SuperscriptBox["\[Chi]", "2"]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"V", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["Mp", "4"], "/", 
              RowBox[{"(", 
               RowBox[{"4", " ", 
                SuperscriptBox["f", "2"]}], ")"}]}], ")"}], 
            RowBox[{"(", 
             RowBox[{"VPBH", "+", "V\[Chi]"}], ")"}]}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Field", "-", 
            RowBox[{"space", " ", 
             RowBox[{"metric", ":"}]}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"\[Gamma]", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["Mp", "2"], "/", 
              RowBox[{"(", 
               RowBox[{"2", "f"}], ")"}]}], ")"}], 
            RowBox[{"(", GridBox[{
               {
                RowBox[{"1", "+", 
                 RowBox[{"3", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    SuperscriptBox["dfd\[CurlyPhi]", "2"], "/", "f"}], 
                   ")"}]}]}], 
                RowBox[{"3", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"dfd\[CurlyPhi]", " ", "dfd\[Chi]"}], ")"}], "/", 
                   "f"}], ")"}]}]},
               {
                RowBox[{"3", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"dfd\[CurlyPhi]", " ", "dfd\[Chi]"}], ")"}], "/", 
                   "f"}], ")"}]}], 
                RowBox[{"1", "+", 
                 RowBox[{"3", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    SuperscriptBox["dfd\[Chi]", "2"], "/", "f"}], ")"}]}]}]}
              }], ")"}]}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}], " ", 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"--", 
             RowBox[{"-", " ", 
              RowBox[{"BACKGROUND", "               ", "--"}]}]}], "-"}], " ",
            "*)"}], "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}], " ", 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"\[Phi]a", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Symbol", "[", 
               RowBox[{"\"\<\[Phi]\>\"", "<>", 
                RowBox[{"ToString", "[", "a", "]"}]}], "]"}], "[", "Ne", 
              "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"a", ",", "\[ScriptCapitalN]"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"\[Pi]a", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Symbol", "[", 
               RowBox[{"\"\<\[Pi]\>\"", "<>", 
                RowBox[{"ToString", "[", "a", "]"}]}], "]"}], "[", "Ne", 
              "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"a", ",", "\[ScriptCapitalN]"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"\[Sigma]", "=", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"\[Pi]a", "[", 
                RowBox[{"[", "a", "]"}], "]"}], " ", 
               RowBox[{"\[Gamma]", "[", 
                RowBox[{"[", 
                 RowBox[{"a", ",", "b"}], "]"}], "]"}], " ", 
               RowBox[{"\[Pi]a", "[", 
                RowBox[{"[", "b", "]"}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"a", ",", "1", ",", "\[ScriptCapitalN]"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"b", ",", "1", ",", "\[ScriptCapitalN]"}], "}"}]}], 
             "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"\[Gamma]inv", "=", 
           RowBox[{"Inverse", "[", "\[Gamma]", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"\[CapitalGamma]", "=", 
           RowBox[{"Simplify", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "/", "2"}], ")"}], " ", 
               RowBox[{"Sum", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Gamma]inv", "[", 
                   RowBox[{"[", 
                    RowBox[{"a", ",", "f"}], "]"}], "]"}], 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"\[Gamma]", "[", 
                    RowBox[{"[", 
                    RowBox[{"f", ",", "c"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Phi]a", "[", 
                    RowBox[{"[", "b", "]"}], "]"}]}], "]"}], "+", 
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"\[Gamma]", "[", 
                    RowBox[{"[", 
                    RowBox[{"b", ",", "f"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Phi]a", "[", 
                    RowBox[{"[", "c", "]"}], "]"}]}], "]"}], "-", 
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"\[Gamma]", "[", 
                    RowBox[{"[", 
                    RowBox[{"b", ",", "c"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Phi]a", "[", 
                    RowBox[{"[", "f", "]"}], "]"}]}], "]"}]}], ")"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"f", ",", "\[ScriptCapitalN]"}], "}"}]}], "]"}]}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"a", ",", "\[ScriptCapitalN]"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"b", ",", "\[ScriptCapitalN]"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"c", ",", "\[ScriptCapitalN]"}], "}"}]}], "]"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"DdN", "[", "X_", "]"}], ":=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{"X", "[", 
                 RowBox[{"[", "a", "]"}], "]"}], ",", "Ne"}], "]"}], "+", 
              RowBox[{"Sum", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"\[CapitalGamma]", "[", 
                  RowBox[{"[", 
                   RowBox[{"a", ",", "b", ",", "c"}], "]"}], "]"}], " ", 
                 RowBox[{"X", "[", 
                  RowBox[{"[", "b", "]"}], "]"}], " ", 
                 RowBox[{"\[Pi]a", "[", 
                  RowBox[{"[", "c", "]"}], "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"b", ",", "\[ScriptCapitalN]"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"c", ",", "\[ScriptCapitalN]"}], "}"}]}], "]"}]}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"a", ",", "\[ScriptCapitalN]"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"\[Epsilon]", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "/", "2"}], ")"}], 
            SuperscriptBox["\[Sigma]", "2"]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"H", "=", 
           RowBox[{"\[Sqrt]", 
            RowBox[{"(", 
             RowBox[{"V", "/", 
              RowBox[{"(", 
               RowBox[{"3", "-", "\[Epsilon]"}], ")"}]}], ")"}]}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"covVa", "=", 
           RowBox[{"D", "[", 
            RowBox[{"V", ",", 
             RowBox[{"{", "\[Phi]a", "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Va", "=", 
           RowBox[{"\[Gamma]inv", ".", "covVa"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Equations", " ", "of", " ", "Motion"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"\[Phi]eq", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{"\[Phi]a", "[", 
                 RowBox[{"[", "a", "]"}], "]"}], ",", "Ne"}], "]"}], 
              "\[Equal]", 
              RowBox[{"\[Pi]a", "[", 
               RowBox[{"[", "a", "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"a", ",", "\[ScriptCapitalN]"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"\[Pi]eq", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"DdN", "[", "\[Pi]a", "]"}], "[", 
               RowBox[{"[", "a", "]"}], "]"}], "\[Equal]", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"\[Epsilon]", "-", "3"}], ")"}], 
                RowBox[{"\[Pi]a", "[", 
                 RowBox[{"[", "a", "]"}], "]"}]}], "-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "/", 
                  SuperscriptBox["H", "2"]}], ")"}], " ", 
                RowBox[{"Va", "[", 
                 RowBox[{"[", "a", "]"}], "]"}]}]}]}], ",", 
             RowBox[{"{", 
              RowBox[{"a", ",", "\[ScriptCapitalN]"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"\[Phi]IC", "=", 
           RowBox[{"Thread", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"\[Phi]a", " ", "/.", " ", 
               RowBox[{"Ne", "\[Rule]", "Ninitial"}]}], ")"}], "\[Equal]", 
             "\[Phi]initial"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"\[Pi]IC", "=", 
           RowBox[{"Thread", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"\[Pi]a", " ", "/.", " ", 
               RowBox[{"Ne", "\[Rule]", "Ninitial"}]}], ")"}], "\[Equal]", 
             "\[Pi]initial"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"bgeqs", "=", 
           RowBox[{"Join", "[", 
            RowBox[{
            "\[Phi]eq", ",", "\[Pi]eq", ",", "\[Phi]IC", ",", "\[Pi]IC"}], 
            "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"\[Phi]params", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Symbol", "[", 
              RowBox[{"\"\<\[Phi]\>\"", "<>", 
               RowBox[{"ToString", "[", "a", "]"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"a", ",", "\[ScriptCapitalN]"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"\[Pi]params", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Symbol", "[", 
              RowBox[{"\"\<\[Pi]\>\"", "<>", 
               RowBox[{"ToString", "[", "a", "]"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"a", ",", "\[ScriptCapitalN]"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"bgparams", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"\[Phi]params", ",", "\[Pi]params"}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"Nendsilly", "=", "300"}], ";", " ", 
          RowBox[{"(*", 
           RowBox[{
           "Absurdly", " ", "large", " ", "Nend", " ", "as", " ", "a", " ", 
            "test", " ", "result"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"endevent", "=", 
           RowBox[{"\[Epsilon]", "-", "1"}]}], ";", " ", 
          RowBox[{"(*", 
           RowBox[{
           "Event", " ", "for", " ", "which", " ", "inflation", " ", "ends"}],
            "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"bgSol", "=", 
           RowBox[{
            RowBox[{"NDSolve", "[", 
             RowBox[{"bgeqs", ",", "bgparams", ",", 
              RowBox[{"{", 
               RowBox[{"Ne", ",", "Ninitial", ",", "Nendsilly"}], "}"}], ",", 
              RowBox[{"Method", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\"\<EventLocator\>\"", ",", 
                 RowBox[{"\"\<Event\>\"", "\[Rule]", 
                  RowBox[{"{", "endevent", "}"}]}], ",", 
                 RowBox[{"\"\<EventCondition\>\"", "->", 
                  RowBox[{"(", 
                   RowBox[{"Ne", ">=", "5"}], ")"}]}]}], "}"}]}], ",", 
              RowBox[{"PrecisionGoal", "\[Rule]", "bgPrecGoal"}], ",", 
              RowBox[{"WorkingPrecision", "\[Rule]", "bgWorkPrec"}], ",", 
              RowBox[{"AccuracyGoal", "->", "bgAccGoal"}], ",", 
              RowBox[{"MaxSteps", "\[Rule]", "\[Infinity]"}]}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"Nend", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"InterpolatingFunctionDomain", "[", 
              RowBox[{"\[Phi]1", "/.", " ", "bgSol"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", 
               RowBox[{"-", "1"}]}], "]"}], "]"}], "-", "NendSkip"}]}], ";", 
          " ", 
          RowBox[{"(*", " ", 
           RowBox[{
           "added", " ", "NendSkip", " ", "to", " ", "avoid", " ", 
            "numerical", " ", "problems", " ", "in", " ", "P", 
            RowBox[{"(", "k", ")"}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"NeHXii", "==", "1"}], ",", 
            RowBox[{"Print", "[", 
             RowBox[{"\"\<Nend=\>\"", ",", "Nend"}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Sanity", " ", 
            RowBox[{"checks", ":"}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"Nend", "<", 
             RowBox[{"Nstar", "+", "5"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{"Style", "[", 
               RowBox[{
               "\"\<PROBLEM: Not enough e-folds of inflation! Evaluation \
aborted.\>\"", ",", "14", ",", "Red"}], "]"}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"FrontEndExecute", "[", 
              RowBox[{"FrontEndToken", "[", "\"\<EvaluatorAbort\>\"", "]"}], 
              "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"Nend", "\[Equal]", "Nendsilly"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{"Style", "[", 
               RowBox[{
               "\"\<PROBLEM: Inflation does not end \
(Nend\[GreaterEqual]Nendsilly)! Evaluation aborted.\>\"", ",", "14", ",", 
                "Red"}], "]"}], "]"}], ";", 
             RowBox[{"FrontEndExecute", "[", 
              RowBox[{"FrontEndToken", "[", "\"\<EvaluatorAbort\>\"", "]"}], 
              "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"a", "=", "1"}], ",", 
            RowBox[{"a", "<=", "\[ScriptCapitalN]"}], ",", 
            RowBox[{"a", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"Evaluate", "[", 
               RowBox[{"\[Phi]a", "[", 
                RowBox[{"[", "a", "]"}], "]"}], "]"}], "=", 
              RowBox[{
               RowBox[{"\[Phi]a", "[", 
                RowBox[{"[", "a", "]"}], "]"}], "/.", "bgSol"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Evaluate", "[", 
               RowBox[{"\[Pi]a", "[", 
                RowBox[{"[", "a", "]"}], "]"}], "]"}], "=", 
              RowBox[{
               RowBox[{"\[Pi]a", "[", 
                RowBox[{"[", "a", "]"}], "]"}], "/.", "bgSol"}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Clear", "[", "a", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"\[Phi]a", "=", 
           RowBox[{"\[Phi]a", "/.", "bgSol"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"\[Pi]a", "=", 
           RowBox[{"\[Pi]a", "/.", "bgSol"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"\[Sigma]", "=", 
           RowBox[{"\[Sigma]", "/.", "bgSol"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"V", "=", 
           RowBox[{"V", "/.", "bgSol"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"\[Epsilon]", "=", 
           RowBox[{"\[Epsilon]", "/.", "bgSol"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"H", "=", 
           RowBox[{"H", "/.", "bgSol"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"aH", "=", 
           RowBox[{
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"(", 
              RowBox[{"Ne", "-", "Npivot"}], ")"}]], " ", "H"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Slow", "-", 
            RowBox[{"Roll", " ", "Power", " ", "Spectrum"}]}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"\[ScriptCapitalQ]\[ScriptCapitalR]k", "[", "N_", "]"}], ":=", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", 
               RowBox[{"(", 
                RowBox[{"8", 
                 SuperscriptBox["\[Pi]", "2"]}], ")"}]}], ")"}], 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["H", "2"], "/", "\[Epsilon]"}], ")"}]}], "/.", 
            RowBox[{"Ne", "->", "N"}]}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Density", ",", " ", "Pressure", ",", " ", 
            RowBox[{"and", " ", "EoS"}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"\[Rho]", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", "2"}], ")"}], 
             SuperscriptBox["H", "2"], " ", 
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"\[Pi]a", "[", 
                 RowBox[{"[", "a", "]"}], "]"}], " ", 
                RowBox[{"\[Gamma]", "[", 
                 RowBox[{"[", 
                  RowBox[{"a", ",", "b"}], "]"}], "]"}], " ", 
                RowBox[{"\[Pi]a", "[", 
                 RowBox[{"[", "b", "]"}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"a", ",", "1", ",", "2"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"b", ",", "1", ",", "2"}], "}"}]}], "]"}]}], "+", 
            "V"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"p", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", "2"}], ")"}], 
             SuperscriptBox["H", "2"], " ", 
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"\[Pi]a", "[", 
                 RowBox[{"[", "a", "]"}], "]"}], " ", 
                RowBox[{"\[Gamma]", "[", 
                 RowBox[{"[", 
                  RowBox[{"a", ",", "b"}], "]"}], "]"}], " ", 
                RowBox[{"\[Pi]a", "[", 
                 RowBox[{"[", "b", "]"}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"a", ",", "1", ",", "2"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"b", ",", "1", ",", "2"}], "}"}]}], "]"}]}], "-", 
            "V"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"\[Omega]EoS", "=", 
           RowBox[{"p", "/", "\[Rho]"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}], " ", 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"--", 
             RowBox[{"-", " ", 
              RowBox[{"PERTURBATIONS", "            ", "--"}]}]}], "-"}], " ",
            "*)"}], "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}], " ", 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"det\[Gamma]", "=", 
           RowBox[{"SetPrecision", "[", 
            RowBox[{
             RowBox[{"Det", "[", "\[Gamma]", "]"}], ",", "bgWorkPrec"}], 
            "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"eTa", "=", 
           RowBox[{"\[Pi]a", "/", "\[Sigma]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"eNa", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "/", 
              RowBox[{"(", 
               RowBox[{"\[Sigma]", " ", 
                RowBox[{"Sqrt", "[", "det\[Gamma]", "]"}]}], ")"}]}], ")"}], 
            " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"\[Gamma]", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "2"}], "]"}], "]"}]}], " ", 
                RowBox[{"\[Pi]1", "[", "Ne", "]"}]}], "-", 
               RowBox[{
                RowBox[{"\[Gamma]", "[", 
                 RowBox[{"[", 
                  RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", 
                RowBox[{"\[Pi]2", "[", "Ne", "]"}]}]}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"\[Gamma]", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
                RowBox[{"\[Pi]1", "[", "Ne", "]"}]}], "+", 
               RowBox[{
                RowBox[{"\[Gamma]", "[", 
                 RowBox[{"[", 
                  RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", 
                RowBox[{"\[Pi]2", "[", "Ne", "]"}]}]}]}], "}"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"V\[Phi]", "=", 
           RowBox[{"eTa", ".", "covVa"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"VN", "=", 
           RowBox[{"eNa", ".", "covVa"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"DH", "=", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{"1", "/", "2"}], ")"}]}], " ", "H", " ", 
            SuperscriptBox["\[Sigma]", "2"]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"D\[Sigma]", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "3"}], " ", "\[Sigma]"}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", 
               SuperscriptBox["H", "2"]}], ")"}], " ", "V\[Phi]"}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"DH", "/", "H"}], ")"}], " ", "\[Sigma]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"DDH", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"(", 
               RowBox[{"1", "/", "2"}], ")"}]}], " ", "DH", " ", 
             SuperscriptBox["\[Sigma]", "2"]}], "-", 
            RowBox[{"H", " ", "\[Sigma]", " ", "D\[Sigma]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"D\[Pi]a", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"\[Epsilon]", "-", "3"}], ")"}], 
               RowBox[{"\[Pi]a", "[", 
                RowBox[{"[", "a", "]"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "/", 
                 SuperscriptBox["H", "2"]}], ")"}], " ", 
               RowBox[{"Va", "[", 
                RowBox[{"[", "a", "]"}], "]"}]}], "-", 
              RowBox[{"Sum", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"\[CapitalGamma]", "[", 
                  RowBox[{"[", 
                   RowBox[{"a", ",", "b", ",", "c"}], "]"}], "]"}], " ", 
                 RowBox[{"\[Pi]a", "[", 
                  RowBox[{"[", "b", "]"}], "]"}], " ", 
                 RowBox[{"\[Pi]a", "[", 
                  RowBox[{"[", "c", "]"}], "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"b", ",", "1", ",", "\[ScriptCapitalN]"}], "}"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"c", ",", "1", ",", "\[ScriptCapitalN]"}], "}"}]}], 
               "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"a", ",", "1", ",", "\[ScriptCapitalN]"}], "}"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"DeTa", "=", 
           RowBox[{
            RowBox[{"D\[Pi]a", "/", "\[Sigma]"}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"\[Pi]a", " ", "D\[Sigma]"}], ")"}], "/", 
             SuperscriptBox["\[Sigma]", "2"]}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"DeNa", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", 
               RowBox[{"(", 
                RowBox[{"\[Sigma]", " ", 
                 RowBox[{"Sqrt", "[", "det\[Gamma]", "]"}]}], ")"}]}], ")"}], 
             " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"D", "[", 
                   RowBox[{
                    RowBox[{"\[Gamma]", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", "Ne"}], 
                   "]"}]}], " ", 
                 RowBox[{"\[Pi]a", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "-", 
                RowBox[{
                 RowBox[{"\[Gamma]", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", 
                 RowBox[{"D\[Pi]a", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "-", 
                RowBox[{
                 RowBox[{"D", "[", 
                  RowBox[{
                   RowBox[{"\[Gamma]", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", "Ne"}], "]"}],
                  " ", 
                 RowBox[{"\[Pi]a", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "-", 
                RowBox[{
                 RowBox[{"\[Gamma]", "[", 
                  RowBox[{"[", 
                   RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", 
                 RowBox[{"D\[Pi]a", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"D", "[", 
                  RowBox[{
                   RowBox[{"\[Gamma]", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "Ne"}], "]"}],
                  " ", 
                 RowBox[{"\[Pi]a", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"\[Gamma]", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
                 RowBox[{"D\[Pi]a", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"D", "[", 
                  RowBox[{
                   RowBox[{"\[Gamma]", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", "Ne"}], "]"}],
                  " ", 
                 RowBox[{"\[Pi]a", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"\[Gamma]", "[", 
                  RowBox[{"[", 
                   RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", 
                 RowBox[{"D\[Pi]a", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}]}]}], "}"}]}], "-", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"D\[Sigma]", " ", 
                  RowBox[{"Sqrt", "[", "det\[Gamma]", "]"}]}], "+", 
                 RowBox[{"\[Sigma]", " ", 
                  RowBox[{"(", 
                   RowBox[{"1", "/", 
                    RowBox[{"(", 
                    RowBox[{"2", " ", 
                    RowBox[{"Sqrt", "[", "det\[Gamma]", "]"}]}], ")"}]}], 
                   ")"}], " ", 
                  RowBox[{"D", "[", 
                   RowBox[{"det\[Gamma]", ",", "Ne"}], "]"}]}]}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["\[Sigma]", "2"], " ", "det\[Gamma]"}], 
                ")"}]}], ")"}], " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"\[Gamma]", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}]}], " ", 
                 RowBox[{"\[Pi]a", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "-", 
                RowBox[{
                 RowBox[{"\[Gamma]", "[", 
                  RowBox[{"[", 
                   RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", 
                 RowBox[{"\[Pi]a", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"\[Gamma]", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", 
                 RowBox[{"\[Pi]a", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"\[Gamma]", "[", 
                  RowBox[{"[", 
                   RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", 
                 RowBox[{"\[Pi]a", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}]}]}], "}"}]}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"DV\[Phi]", "=", 
           RowBox[{
            RowBox[{"DeTa", ".", "covVa"}], "+", 
            RowBox[{"eTa", ".", 
             RowBox[{"D", "[", 
              RowBox[{"covVa", ",", "Ne"}], "]"}]}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"DVN", "=", 
           RowBox[{
            RowBox[{"DeNa", ".", "covVa"}], "+", 
            RowBox[{"eNa", ".", 
             RowBox[{"D", "[", 
              RowBox[{"covVa", ",", "Ne"}], "]"}]}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"DD\[Sigma]", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "3"}], " ", "D\[Sigma]"}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", 
               SuperscriptBox["H", "2"]}], ")"}], " ", "DV\[Phi]"}], "+", 
            RowBox[{"V\[Phi]", " ", 
             RowBox[{"(", 
              RowBox[{"2", "/", 
               SuperscriptBox["H", "3"]}], ")"}], " ", "DH"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"3", "/", "2"}], ")"}], " ", 
             SuperscriptBox["\[Sigma]", "2"], " ", "D\[Sigma]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"\[Eta]T", "=", 
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"DH", " ", "\[Sigma]"}], "+", 
                RowBox[{"H", " ", "D\[Sigma]"}]}], ")"}], "/", 
              RowBox[{"(", 
               RowBox[{"H", " ", "\[Sigma]"}], ")"}]}], ")"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"\[Eta]N", "=", 
           RowBox[{"VN", "/", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["H", "2"], " ", "\[Sigma]"}], ")"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"\[Eta]BF", "=", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{"D\[Sigma]", "/", "\[Sigma]"}], ")"}]}]}], ";", " ", 
          RowBox[{"(*", 
           RowBox[{
           "also", " ", "known", " ", "in", " ", "literature", " ", "as", " ", 
            SubscriptBox["\[Epsilon]", "2"]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"\[Eta]", "=", 
           RowBox[{
            SuperscriptBox["\[Sigma]", "2"], "-", 
            RowBox[{"D\[Sigma]", "/", "\[Sigma]"}]}]}], ";", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
             RowBox[{"Dave", "'"}], "s", " ", "version", " ", "of", " ", 
             "\[Eta]"}], "=", 
            RowBox[{
             RowBox[{"2", "\[Epsilon]"}], "-", 
             RowBox[{
              SubscriptBox["\[Epsilon]", "2"], "/", "2"}]}]}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"D\[Eta]N", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "/", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["\[Sigma]", "2"], " ", 
                SuperscriptBox["H", "4"]}], ")"}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"DVN", " ", 
               SuperscriptBox["H", "2"], " ", "\[Sigma]"}], "-", 
              RowBox[{"2", " ", "H", " ", "DH", " ", "VN", " ", "\[Sigma]"}], 
              "-", 
              RowBox[{
               SuperscriptBox["H", "2"], "D\[Sigma]", " ", "VN"}]}], 
             ")"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"\[Xi]T", "=", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{"1", "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"H", " ", "DH", " ", "\[Sigma]"}], "+", 
                 RowBox[{
                  SuperscriptBox["H", "2"], " ", "D\[Sigma]"}]}], ")"}]}], 
              ")"}]}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["DH", "2"], "+", 
                 RowBox[{"H", " ", "DDH"}]}], ")"}], " ", "\[Sigma]"}], "+", 
              RowBox[{"3", " ", "H", " ", "DH", " ", "D\[Sigma]"}], "+", 
              RowBox[{
               SuperscriptBox["H", "2"], " ", "DD\[Sigma]"}]}], ")"}]}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"\[Xi]N", "=", 
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"D\[Eta]N", "/", "\[Eta]N"}], ")"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"VNN", "=", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"eNa", "[", 
               RowBox[{"[", "a", "]"}], "]"}], " ", 
              RowBox[{"eNa", "[", 
               RowBox[{"[", "b", "]"}], "]"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{"covVa", "[", 
                   RowBox[{"[", "a", "]"}], "]"}], ",", 
                  RowBox[{"\[Phi]a", "[", 
                   RowBox[{"[", "b", "]"}], "]"}]}], "]"}], "-", 
                RowBox[{"Sum", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[CapitalGamma]", "[", 
                    RowBox[{"[", 
                    RowBox[{"c", ",", "a", ",", "b"}], "]"}], "]"}], " ", 
                   RowBox[{"covVa", "[", 
                    RowBox[{"[", "c", "]"}], "]"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"c", ",", "\[ScriptCapitalN]"}], "}"}]}], "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"a", ",", "\[ScriptCapitalN]"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"b", ",", "\[ScriptCapitalN]"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"V\[Phi]\[Phi]", "=", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"eTa", "[", 
               RowBox[{"[", "a", "]"}], "]"}], " ", 
              RowBox[{"eTa", "[", 
               RowBox[{"[", "b", "]"}], "]"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{"covVa", "[", 
                   RowBox[{"[", "a", "]"}], "]"}], ",", 
                  RowBox[{"\[Phi]a", "[", 
                   RowBox[{"[", "b", "]"}], "]"}]}], "]"}], "-", 
                RowBox[{"Sum", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[CapitalGamma]", "[", 
                    RowBox[{"[", 
                    RowBox[{"c", ",", "a", ",", "b"}], "]"}], "]"}], " ", 
                   RowBox[{"covVa", "[", 
                    RowBox[{"[", "c", "]"}], "]"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"c", ",", "\[ScriptCapitalN]"}], "}"}]}], "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"a", ",", "\[ScriptCapitalN]"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"b", ",", "\[ScriptCapitalN]"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"\[DoubleStruckCapitalR]ab", "=", 
           RowBox[{"Chop", "[", 
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"Sum", "[", 
                RowBox[{
                 RowBox[{"D", "[", 
                  RowBox[{
                   RowBox[{"\[CapitalGamma]", "[", 
                    RowBox[{"[", 
                    RowBox[{"c", ",", "a", ",", "b"}], "]"}], "]"}], ",", 
                   RowBox[{"\[Phi]a", "[", 
                    RowBox[{"[", "c", "]"}], "]"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"c", ",", "\[ScriptCapitalN]"}], "}"}]}], "]"}], 
               "-", 
               RowBox[{"Sum", "[", 
                RowBox[{
                 RowBox[{"D", "[", 
                  RowBox[{
                   RowBox[{"\[CapitalGamma]", "[", 
                    RowBox[{"[", 
                    RowBox[{"c", ",", "b", ",", "c"}], "]"}], "]"}], ",", 
                   RowBox[{"\[Phi]a", "[", 
                    RowBox[{"[", "a", "]"}], "]"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"c", ",", "\[ScriptCapitalN]"}], "}"}]}], "]"}], 
               "+", 
               RowBox[{"Sum", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[CapitalGamma]", "[", 
                   RowBox[{"[", 
                    RowBox[{"c", ",", "a", ",", "b"}], "]"}], "]"}], " ", 
                  RowBox[{"\[CapitalGamma]", "[", 
                   RowBox[{"[", 
                    RowBox[{"d", ",", "c", ",", "d"}], "]"}], "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"c", ",", "\[ScriptCapitalN]"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"d", ",", "\[ScriptCapitalN]"}], "}"}]}], "]"}], 
               "-", 
               RowBox[{"Sum", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[CapitalGamma]", "[", 
                   RowBox[{"[", 
                    RowBox[{"c", ",", "a", ",", "d"}], "]"}], "]"}], " ", 
                  RowBox[{"\[CapitalGamma]", "[", 
                   RowBox[{"[", 
                    RowBox[{"d", ",", "c", ",", "b"}], "]"}], "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"c", ",", "\[ScriptCapitalN]"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"d", ",", "\[ScriptCapitalN]"}], "}"}]}], "]"}]}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"a", ",", "\[ScriptCapitalN]"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"b", ",", "\[ScriptCapitalN]"}], "}"}]}], "]"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"\[DoubleStruckCapitalR]", "=", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Gamma]inv", "[", 
               RowBox[{"[", 
                RowBox[{"a", ",", "b"}], "]"}], "]"}], " ", 
              RowBox[{"\[DoubleStruckCapitalR]ab", "[", 
               RowBox[{"[", 
                RowBox[{"a", ",", "b"}], "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"a", ",", "\[ScriptCapitalN]"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"b", ",", "\[ScriptCapitalN]"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"M2vN", "=", 
           RowBox[{"VNN", "+", 
            RowBox[{
             SuperscriptBox["H", "2"], " ", "\[Epsilon]", " ", 
             "\[DoubleStruckCapitalR]"}]}]}], ";", " ", 
          RowBox[{"(*", 
           RowBox[{
           "effective", " ", "mass", " ", "squared", " ", "of", " ", "the", 
            " ", 
            SuperscriptBox["v", "N"], " ", "isocurvature", " ", 
            RowBox[{"pert", "."}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"mseff2", "=", 
             RowBox[{"M2vN", "+", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 SuperscriptBox["H", "2"], 
                 RowBox[{"(", " ", 
                  RowBox[{"DD\[Sigma]", "/", "\[Sigma]"}], ")"}]}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"H", " ", "DH"}], "+", 
                   RowBox[{"3", 
                    SuperscriptBox["H", "2"]}]}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"D\[Sigma]", "/", "\[Sigma]"}], ")"}]}]}], 
               ")"}]}]}], ";"}], "*)"}], " ", "\[IndentingNewLine]", 
          RowBox[{"\[Mu]S", "=", 
           RowBox[{"M2vN", "-", "V\[Phi]\[Phi]", "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["H", "2"], " ", "\[Epsilon]", 
             RowBox[{"(", 
              RowBox[{"3", "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"\[Sigma]", " ", "D\[Sigma]"}], ")"}], "/", 
                "\[Epsilon]"}], "-", "\[Epsilon]"}], ")"}]}], "+", 
            RowBox[{"4", " ", 
             SuperscriptBox["\[Omega]", "2"]}]}]}], ";", " ", 
          RowBox[{"(*", 
           RowBox[{
           "effective", " ", "mass", " ", "squared", " ", "of", " ", "the", 
            " ", "\[ScriptCapitalS]", " ", "isocurvature", " ", 
            RowBox[{"pert", "."}]}], "*)"}], "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"\[CapitalOmega]TT", "=", 
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"2", "+", 
              RowBox[{"2", " ", "\[Epsilon]"}], "-", 
              RowBox[{"3", " ", "\[Eta]T"}], "+", 
              RowBox[{"\[Eta]T", " ", "\[Xi]T"}], "-", 
              RowBox[{"4", " ", "\[Epsilon]", " ", "\[Eta]T"}], "+", 
              RowBox[{"2", " ", 
               SuperscriptBox["\[Epsilon]", "2"]}], "-", 
              SuperscriptBox["\[Eta]N", "2"]}], ")"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"\[CapitalOmega]NN", "=", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{"2", "-", "\[Epsilon]"}], ")"}]}], "+", 
            RowBox[{"M2vN", "/", 
             SuperscriptBox["H", "2"]}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"\[CapitalOmega]TN", "=", 
             RowBox[{"\[CapitalOmega]NT", "=", 
              RowBox[{"\[Eta]N", " ", 
               RowBox[{"(", 
                RowBox[{"3", "+", "\[Epsilon]", "-", 
                 RowBox[{"2", " ", "\[Eta]T"}], "-", "\[Xi]N"}], ")"}]}]}]}], 
            ";"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"AllTrue", "[", 
             RowBox[{
              RowBox[{"\[Eta]N", "/.", 
               RowBox[{"Ne", "->", 
                RowBox[{"Range", "[", 
                 RowBox[{
                  RowBox[{"1", "/", "10"}], ",", "Nend", ",", 
                  RowBox[{"1", "/", "10"}]}], "]"}]}]}], ",", 
              "PossibleZeroQ"}], "]"}], ",", 
            RowBox[{"\[CapitalOmega]TN", "=", 
             RowBox[{"\[CapitalOmega]NT", "=", "0"}]}], ",", 
            RowBox[{"\[CapitalOmega]TN", "=", 
             RowBox[{"\[CapitalOmega]NT", "=", 
              RowBox[{"\[Eta]N", " ", 
               RowBox[{"(", 
                RowBox[{"3", "+", "\[Epsilon]", "-", 
                 RowBox[{"2", " ", "\[Eta]T"}], "-", "\[Xi]N"}], 
                ")"}]}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"to", " ", "avoid", " ", 
            RowBox[{"1", "/", "0"}], " ", "when", " ", "no", " ", "turn", " ",
             "present", " ", 
            RowBox[{"(", 
             RowBox[{"single", "-", 
              RowBox[{"field", " ", "limit"}]}], ")"}]}], "*)"}], 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Definition", " ", "of", " ", "turn", " ", "rate", " ", 
            RowBox[{"from", " ", "[", "2010.04179", "]"}]}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"\[Omega]", "=", 
           RowBox[{
            RowBox[{"Sqrt", "[", "det\[Gamma]", "]"}], " ", "H", " ", 
            RowBox[{"eTa", ".", 
             RowBox[{"LeviCivitaTensor", "[", "2", "]"}], ".", "DeTa"}]}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"\[Omega]overH", "=", 
           RowBox[{
            RowBox[{"Sqrt", "[", "det\[Gamma]", "]"}], " ", 
            RowBox[{"eTa", ".", 
             RowBox[{"LeviCivitaTensor", "[", "2", "]"}], ".", "DeTa"}]}]}], 
          ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"USR", " ", "Power", " ", "spectra"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"\[ScriptCapitalP]\[ScriptCapitalR]k", "[", 
            RowBox[{"k_", ",", "N_", ",", "pSol_", ",", "bSol_"}], "]"}], ":=", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["k", "3"], "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"4", " ", 
                  SuperscriptBox["\[Pi]", "2"], " ", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"Ne", "-", "Npivot"}]], ")"}], "2"], " ", 
                  "\[Epsilon]"}], "/.", "bSol"}], ")"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"Abs", "[", 
                 RowBox[{
                  RowBox[{"vT1", "[", "Ne", "]"}], "/.", " ", "pSol"}], "]"}],
                 "2"], "+", 
               SuperscriptBox[
                RowBox[{"Abs", "[", 
                 RowBox[{
                  RowBox[{"vT2", "[", "Ne", "]"}], "/.", " ", "pSol"}], "]"}],
                 "2"]}], ")"}]}], "/.", " ", 
            RowBox[{"Ne", "->", "N"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"\[ScriptCapitalP]\[ScriptCapitalS]k", "[", 
            RowBox[{"k_", ",", "N_", ",", "pSol_", ",", "bSol_"}], "]"}], ":=", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["k", "3"], "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"4", " ", 
                  SuperscriptBox["\[Pi]", "2"], " ", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"Ne", "-", "Npivot"}]], ")"}], "2"], " ", 
                  "\[Epsilon]"}], "/.", "bSol"}], ")"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"Abs", "[", 
                 RowBox[{
                  RowBox[{"vN1", "[", "Ne", "]"}], "/.", " ", "pSol"}], "]"}],
                 "2"], "+", 
               SuperscriptBox[
                RowBox[{"Abs", "[", 
                 RowBox[{
                  RowBox[{"vN2", "[", "Ne", "]"}], "/.", " ", "pSol"}], "]"}],
                 "2"]}], ")"}]}], "/.", " ", 
            RowBox[{"Ne", "->", "N"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "\[ScriptCapitalP]\[ScriptCapitalR]\[ScriptCapitalS]k", "[", 
            RowBox[{"k_", ",", "N_", ",", "pSol_", ",", "bSol_"}], "]"}], ":=", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["k", "3"], "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"4", " ", 
                  SuperscriptBox["\[Pi]", "2"], " ", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{"Ne", "-", "Npivot"}]], ")"}], "2"], " ", 
                  "\[Epsilon]"}], "/.", "bSol"}], ")"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Re", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"vT1", "[", "Ne", "]"}], "/.", " ", "pSol"}], 
                  ")"}], " ", 
                 RowBox[{"Conjugate", "[", 
                  RowBox[{
                   RowBox[{"vN1", "[", "Ne", "]"}], "/.", " ", "pSol"}], 
                  "]"}]}], "]"}], "+", 
               RowBox[{"Re", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"vT2", "[", "Ne", "]"}], "/.", " ", "pSol"}], 
                  ")"}], " ", 
                 RowBox[{"Conjugate", "[", 
                  RowBox[{
                   RowBox[{"vN2", "[", "Ne", "]"}], "/.", " ", "pSol"}], 
                  "]"}]}], "]"}]}], ")"}]}], "/.", " ", 
            RowBox[{"Ne", "->", "N"}]}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Calculate", " ", "k"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"kx", "[", 
            RowBox[{"Nx_", ",", 
             RowBox[{"Npiv_", ":", "Npivot"}], ",", 
             RowBox[{"bSol_", ":", 
              RowBox[{"{", "}"}]}]}], "]"}], ":=", 
           RowBox[{
            RowBox[{
             RowBox[{
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"(", 
                RowBox[{"Nx", "-", "Npiv"}], ")"}]], " ", "H"}], "/.", 
             "bSol"}], "/.", 
            RowBox[{"Ne", "->", "Nx"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"kr", "[", 
            RowBox[{"Nx_", ",", 
             RowBox[{"Ncmb_", ":", 
              RowBox[{"NendReal", "-", "Nstar"}]}], ",", 
             RowBox[{"bSol_", ":", 
              RowBox[{"{", "}"}]}]}], "]"}], ":=", 
           RowBox[{
            RowBox[{"kx", "[", 
             RowBox[{"Nx", ",", "0", ",", "bSol"}], "]"}], "/", 
            RowBox[{"kx", "[", 
             RowBox[{"Ncmb", ",", "0", ",", "bSol"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"ks", "=", 
           RowBox[{
            RowBox[{"kx", "[", 
             RowBox[{"NeHX", "[", 
              RowBox[{"[", "NeHXii", "]"}], "]"}], "]"}], "/.", "bgSol"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"ksRatio", "=", 
           RowBox[{
            RowBox[{"kr", "[", 
             RowBox[{
              RowBox[{"NeHX", "[", 
               RowBox[{"[", "NeHXii", "]"}], "]"}], ",", 
              RowBox[{"NendReal", "-", "Nstar"}]}], "]"}], "/.", "bgSol"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"NBD", "=", 
           RowBox[{
            RowBox[{"NeHX", "[", 
             RowBox[{"[", "NeHXii", "]"}], "]"}], "-", "5"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Equations", " ", "of", " ", "Motion"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"vI\[Alpha]BD", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "/", 
              RowBox[{"(", 
               RowBox[{"\[Sqrt]", 
                RowBox[{"(", 
                 RowBox[{"2", " ", "ks"}], ")"}]}], ")"}]}], ")"}], 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", " ", "I"}], " ", "ks", " ", 
              RowBox[{"(", " ", 
               RowBox[{"1", "/", 
                RowBox[{"(", 
                 RowBox[{"aH", "/.", " ", 
                  RowBox[{"Ne", "->", "NBD"}]}], ")"}]}], ")"}]}], "]"}]}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"DvI\[Alpha]BD", "=", 
           RowBox[{
            RowBox[{"-", "I"}], " ", 
            RowBox[{"\[Sqrt]", 
             RowBox[{"(", 
              RowBox[{"ks", "/", "2"}], ")"}]}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "/", 
              RowBox[{"(", 
               RowBox[{"aH", "/.", " ", 
                RowBox[{"Ne", "->", "NBD"}]}], ")"}]}], ")"}], 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", " ", "I"}], " ", "ks", " ", 
              RowBox[{"(", " ", 
               RowBox[{"1", "/", 
                RowBox[{"(", 
                 RowBox[{"aH", "/.", " ", 
                  RowBox[{"Ne", "->", "NBD"}]}], ")"}]}], ")"}]}], "]"}]}]}], 
          ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"\[ScriptCapitalN]x", "==", "1"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"pertIC", "=", 
              RowBox[{"{", " ", 
               RowBox[{"(*", " ", 
                RowBox[{
                 RowBox[{
                  RowBox[{"For", " ", "efective", " ", "single"}], "-", 
                  "field"}], ",", " ", 
                 RowBox[{"need", " ", "vanishing", " ", 
                  RowBox[{"I", ".", "C", ".", " ", "for"}], " ", "the", " ", 
                  "normal", " ", 
                  RowBox[{"mode", "!"}]}]}], " ", "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"vT1", "[", "NBD", "]"}], "==", "vI\[Alpha]BD"}], 
                ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"vT1", "'"}], "[", "NBD", "]"}], "==", 
                 "DvI\[Alpha]BD"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"vT2", "[", "NBD", "]"}], "==", "0"}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"vT2", "'"}], "[", "NBD", "]"}], "==", "0"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"vN1", "[", "NBD", "]"}], "==", "0"}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"vN1", "'"}], "[", "NBD", "]"}], "==", "0"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"vN2", "[", "NBD", "]"}], "==", "0"}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"vN2", "'"}], "[", "NBD", "]"}], "==", "0"}]}], 
               "\[IndentingNewLine]", "}"}]}], ";"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"pertIC", "=", 
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"vT1", "[", "NBD", "]"}], "==", "vI\[Alpha]BD"}], 
                ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"vT1", "'"}], "[", "NBD", "]"}], "==", 
                 "DvI\[Alpha]BD"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"vT2", "[", "NBD", "]"}], "==", "0"}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"vT2", "'"}], "[", "NBD", "]"}], "==", "0"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"vN1", "[", "NBD", "]"}], "==", "0"}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"vN1", "'"}], "[", "NBD", "]"}], "==", "0"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"vN2", "[", "NBD", "]"}], "==", "vI\[Alpha]BD"}], 
                ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"vN2", "'"}], "[", "NBD", "]"}], "==", 
                 "DvI\[Alpha]BD"}]}], "\[IndentingNewLine]", "}"}]}], ";"}]}],
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"pertEoM", "=", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"vT1", "''"}], "[", "Ne", "]"}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", "\[Epsilon]"}], ")"}], " ", 
                RowBox[{
                 RowBox[{"vT1", "'"}], "[", "Ne", "]"}]}], "+", 
               RowBox[{"2", " ", "\[Eta]N", " ", 
                RowBox[{
                 RowBox[{"vN1", "'"}], "[", "Ne", "]"}]}], "-", 
               RowBox[{
                SuperscriptBox["\[Eta]N", "2"], " ", 
                RowBox[{"vT1", "[", "Ne", "]"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "\[Epsilon]"}], ")"}], " ", "\[Eta]N"}],
                   " ", "+", "D\[Eta]N"}], ")"}], " ", 
                RowBox[{"vN1", "[", "Ne", "]"}]}], "+", 
               RowBox[{"\[CapitalOmega]TN", " ", 
                RowBox[{"vN1", "[", "Ne", "]"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"\[CapitalOmega]TT", "+", 
                  RowBox[{
                   SuperscriptBox["ks", "2"], "/", 
                   SuperscriptBox["aH", "2"]}]}], ")"}], " ", 
                RowBox[{"vT1", "[", "Ne", "]"}]}]}], "\[Equal]", "0"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"vN1", "''"}], "[", "Ne", "]"}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", "\[Epsilon]"}], ")"}], " ", 
                RowBox[{
                 RowBox[{"vN1", "'"}], "[", "Ne", "]"}]}], "-", 
               RowBox[{"2", " ", "\[Eta]N", " ", 
                RowBox[{
                 RowBox[{"vT1", "'"}], "[", "Ne", "]"}]}], "-", 
               RowBox[{
                SuperscriptBox["\[Eta]N", "2"], " ", 
                RowBox[{"vN1", "[", "Ne", "]"}]}], "-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "\[Epsilon]"}], ")"}], " ", "\[Eta]N"}],
                   " ", "+", "D\[Eta]N"}], ")"}], " ", 
                RowBox[{"vT1", "[", "Ne", "]"}]}], "+", 
               RowBox[{"\[CapitalOmega]NT", " ", 
                RowBox[{"vT1", "[", "Ne", "]"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"\[CapitalOmega]NN", "+", 
                  RowBox[{
                   SuperscriptBox["ks", "2"], "/", 
                   SuperscriptBox["aH", "2"]}]}], ")"}], " ", 
                RowBox[{"vN1", "[", "Ne", "]"}]}]}], "\[Equal]", "0"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"vT2", "''"}], "[", "Ne", "]"}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", "\[Epsilon]"}], ")"}], " ", 
                RowBox[{
                 RowBox[{"vT2", "'"}], "[", "Ne", "]"}]}], "+", 
               RowBox[{"2", " ", "\[Eta]N", " ", 
                RowBox[{
                 RowBox[{"vN2", "'"}], "[", "Ne", "]"}]}], "-", 
               RowBox[{
                SuperscriptBox["\[Eta]N", "2"], " ", 
                RowBox[{"vT2", "[", "Ne", "]"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "\[Epsilon]"}], ")"}], " ", "\[Eta]N"}],
                   " ", "+", "D\[Eta]N"}], ")"}], " ", 
                RowBox[{"vN2", "[", "Ne", "]"}]}], "+", 
               RowBox[{"\[CapitalOmega]TN", " ", 
                RowBox[{"vN2", "[", "Ne", "]"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"\[CapitalOmega]TT", "+", 
                  RowBox[{
                   SuperscriptBox["ks", "2"], "/", 
                   SuperscriptBox["aH", "2"]}]}], ")"}], " ", 
                RowBox[{"vT2", "[", "Ne", "]"}]}]}], "\[Equal]", "0"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"vN2", "''"}], "[", "Ne", "]"}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", "\[Epsilon]"}], ")"}], " ", 
                RowBox[{
                 RowBox[{"vN2", "'"}], "[", "Ne", "]"}]}], "-", 
               RowBox[{"2", " ", "\[Eta]N", " ", 
                RowBox[{
                 RowBox[{"vT2", "'"}], "[", "Ne", "]"}]}], "-", 
               RowBox[{
                SuperscriptBox["\[Eta]N", "2"], " ", 
                RowBox[{"vN2", "[", "Ne", "]"}]}], "-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "\[Epsilon]"}], ")"}], " ", "\[Eta]N"}],
                   " ", "+", "D\[Eta]N"}], ")"}], " ", 
                RowBox[{"vT2", "[", "Ne", "]"}]}], "+", 
               RowBox[{"\[CapitalOmega]NT", " ", 
                RowBox[{"vT2", "[", "Ne", "]"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"\[CapitalOmega]NN", "+", 
                  RowBox[{
                   SuperscriptBox["ks", "2"], "/", 
                   SuperscriptBox["aH", "2"]}]}], ")"}], " ", 
                RowBox[{"vN2", "[", "Ne", "]"}]}]}], "\[Equal]", "0"}]}], 
            "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"perteqs", "=", 
           RowBox[{
            RowBox[{"Join", "[", 
             RowBox[{"pertEoM", ",", "pertIC"}], "]"}], "/.", "bgSol"}]}], 
          ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Solve", " ", "the", " ", "EoM"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"tmpTime", "=", 
           RowBox[{
            RowBox[{"AbsoluteTiming", "[", 
             RowBox[{"tmpSol", "=", 
              RowBox[{
               RowBox[{"NDSolve", "[", 
                RowBox[{"perteqs", ",", 
                 RowBox[{"{", 
                  RowBox[{"vT1", ",", "vT2", ",", "vN1", ",", "vN2"}], "}"}], 
                 ",", 
                 RowBox[{"{", 
                  RowBox[{"Ne", ",", "NBD", ",", "Nend"}], "}"}], ",", 
                 RowBox[{"Method", "->", "solveMethod"}], ",", 
                 RowBox[{"MaxSteps", "->", 
                  SuperscriptBox["10", "8"]}], ",", 
                 RowBox[{"WorkingPrecision", "->", 
                  RowBox[{"workPrecs", "[", 
                   RowBox[{"[", "NeHXii", "]"}], "]"}]}], ",", 
                 RowBox[{"PrecisionGoal", "->", 
                  RowBox[{"precGoals", "[", 
                   RowBox[{"[", "NeHXii", "]"}], "]"}]}], ",", 
                 RowBox[{"AccuracyGoal", "->", 
                  RowBox[{"accGoals", "[", 
                   RowBox[{"[", "NeHXii", "]"}], "]"}]}]}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", "]"}],
             "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"tmpPRk", "=", 
           RowBox[{"\[ScriptCapitalP]\[ScriptCapitalR]k", "[", 
            RowBox[{"ks", ",", "Nend", ",", "tmpSol", ",", "bgSol"}], "]"}]}],
           ";", "\[IndentingNewLine]", 
          RowBox[{"tmpPSk", "=", 
           RowBox[{"\[ScriptCapitalP]\[ScriptCapitalS]k", "[", 
            RowBox[{"ks", ",", "Nend", ",", "tmpSol", ",", "bgSol"}], "]"}]}],
           ";", "\[IndentingNewLine]", 
          RowBox[{"tmpPRSk", "=", 
           RowBox[{
           "\[ScriptCapitalP]\[ScriptCapitalR]\[ScriptCapitalS]k", "[", 
            RowBox[{"ks", ",", "Nend", ",", "tmpSol", ",", "bgSol"}], "]"}]}],
           ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<Evaluated mode \>\"", "<>", 
            RowBox[{"ToString", "[", "NeHXii", "]"}], "<>", "\"\< of \>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"Length", "[", "NeHX", "]"}], "]"}], "<>", 
            "\"\<.   PRk=\>\"", "<>", 
            RowBox[{"ToString", "[", "tmpPRk", "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"saveSols", "==", "True"}], ",", "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"pertSol", ",", 
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"NeHX", "[", 
                 RowBox[{"[", "NeHXii", "]"}], "]"}], ",", "ks", ",", 
                "ksRatio", ",", "tmpPRk", ",", "tmpPSk", ",", "tmpPRSk", ",", 
                "tmpTime", ",", "tmpSol", " ", ",", "bgSol"}], 
               "\[IndentingNewLine]", "}"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"pertSol", ",", 
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"NeHX", "[", 
                 RowBox[{"[", "NeHXii", "]"}], "]"}], ",", "ks", ",", 
                "ksRatio", ",", "tmpPRk", ",", "tmpPSk", ",", "tmpPRSk", ",", 
                "tmpTime"}], "\[IndentingNewLine]", "}"}]}], "]"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"PRkEnd", ",", "tmpPRk"}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"PSkEnd", ",", "tmpPSk"}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"PRSkEnd", ",", "tmpPRSk"}], "]"}], ";"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"--", 
            RowBox[{"-", " ", 
             RowBox[{"END", " ", "--"}]}]}], "-"}], "*)"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"NeHXii", ",", "1", ",", 
           RowBox[{"Length", "[", "NeHX", "]"}]}], "}"}], ",", 
         RowBox[{"ProgressReporting", "->", "True"}]}], "\[IndentingNewLine]",
         "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Order", " ", "list", " ", "of", " ", "results", " ", "by", " ", 
         "increasing", " ", "NeHX"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"pertSol", "=", 
        RowBox[{"SortBy", "[", 
         RowBox[{"pertSol", ",", "First"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"allSols", ",", "pertSol"}], "]"}], ";", 
       "\[IndentingNewLine]", "pertSol"}]}], "\[IndentingNewLine]", 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.9192465619241085`*^9, 3.919246581673268*^9}, {
   3.921768271361185*^9, 3.921768273978623*^9}, {3.921769399598418*^9, 
   3.9217694038731565`*^9}, {3.921890509570108*^9, 3.921890543390441*^9}, {
   3.921890618215601*^9, 3.9218906639910827`*^9}, 3.921890805377714*^9, {
   3.921932363358519*^9, 3.9219323732862043`*^9}, 3.9227226615420513`*^9, {
   3.922723363453998*^9, 3.9227233661069417`*^9}, {3.922724108788089*^9, 
   3.922724110554535*^9}, 3.9227242153239517`*^9, {3.92497270141363*^9, 
   3.9249727215065145`*^9}, {3.9249964144109926`*^9, 
   3.9249964157128925`*^9}, {3.9250787278214145`*^9, 
   3.9250787474989214`*^9}, {3.9250788259836464`*^9, 
   3.9250788338633275`*^9}, {3.925078887822607*^9, 3.925078888042904*^9}, 
   3.9250790005519066`*^9, {3.925079084693537*^9, 3.925079095066534*^9}, {
   3.925079209360013*^9, 3.925079222245441*^9}, {3.9250892218449855`*^9, 
   3.9250892326327524`*^9}, {3.9250896607508802`*^9, 3.925089661096818*^9}, {
   3.9250897390404587`*^9, 3.925089761315576*^9}, 3.9250947125263133`*^9, {
   3.9252379401731215`*^9, 3.9252379646187153`*^9}, {3.92525158507944*^9, 
   3.9252516020846786`*^9}, {3.925298628051677*^9, 3.9252986380980535`*^9}, {
   3.9252986765570974`*^9, 3.925298683852639*^9}, {3.940528250333256*^9, 
   3.9405282507002573`*^9}, {3.9405302694981575`*^9, 3.940530269880011*^9}, 
   3.940540221659284*^9, {3.940543631098151*^9, 3.9405436432393064`*^9}, {
   3.940551963396867*^9, 3.940551963734863*^9}, {3.9405524124512672`*^9, 
   3.94055242289788*^9}, {3.9405527545914745`*^9, 3.94055275885326*^9}, {
   3.9405543470118723`*^9, 3.9405543549065094`*^9}, {3.9405574888174877`*^9, 
   3.9405575091670127`*^9}, {3.9405979830430045`*^9, 
   3.9405979940750656`*^9}, {3.9410717274711995`*^9, 
   3.9410718008701973`*^9}, {3.941071913998361*^9, 3.941071915804617*^9}, {
   3.9410721006342397`*^9, 3.9410721114271235`*^9}, {3.9410722034527273`*^9, 
   3.941072233123358*^9}, {3.941072308310054*^9, 3.9410723220685186`*^9}, {
   3.941072461126069*^9, 3.9410724712440324`*^9}, 3.9410737753663816`*^9, 
   3.941076826028601*^9, {3.941076863680108*^9, 3.9410768669490595`*^9}, {
   3.9410768970155754`*^9, 3.9410769304195647`*^9}, {3.9410769919943953`*^9, 
   3.9410770407995443`*^9}, {3.94107723193182*^9, 3.9410772785434313`*^9}, {
   3.941077608695505*^9, 3.9410776177395573`*^9}, {3.9410793750545454`*^9, 
   3.941079377322979*^9}, {3.9410800141777697`*^9, 3.941080045684227*^9}, {
   3.9410809870350676`*^9, 3.9410810300380917`*^9}, {3.9411277613045607`*^9, 
   3.941127763661131*^9}, {3.9411287720604525`*^9, 3.9411287752102017`*^9}, {
   3.9411311652559648`*^9, 3.9411311768512807`*^9}, {3.941131428014213*^9, 
   3.941131447184758*^9}, {3.941164478829131*^9, 3.941164493393623*^9}, {
   3.9411645375319595`*^9, 3.9411645746216707`*^9}, {3.9411648213018293`*^9, 
   3.941164912437485*^9}, {3.9411650056309366`*^9, 3.9411650333637877`*^9}, {
   3.94116510859859*^9, 3.941165130195027*^9}, {3.94116524928343*^9, 
   3.941165288984581*^9}, {3.941165536175898*^9, 3.941165585199016*^9}, {
   3.941165646599738*^9, 3.941165760378518*^9}, {3.941165791346631*^9, 
   3.94116581145125*^9}, {3.941166144868383*^9, 3.941166191583151*^9}, {
   3.941166279629507*^9, 3.941166281909661*^9}, {3.9411664136248116`*^9, 
   3.9411664494438276`*^9}, {3.9411664843998394`*^9, 3.94116661677337*^9}, {
   3.9411667095990267`*^9, 3.94116676004265*^9}, {3.9411684890014668`*^9, 
   3.941168503585619*^9}, {3.9411685643981066`*^9, 3.9411685732136955`*^9}, {
   3.9411691091421056`*^9, 3.9411691593754387`*^9}, {3.9411703466149874`*^9, 
   3.941170581663761*^9}, {3.9411709274259634`*^9, 3.9411709455982056`*^9}, {
   3.9411711643802752`*^9, 3.941171194463852*^9}, {3.941253730693633*^9, 
   3.941253751055932*^9}, 3.941287016699198*^9, {3.9416477101167417`*^9, 
   3.94164771070661*^9}, {3.941715825642925*^9, 3.941715826323061*^9}, {
   3.945857926831503*^9, 3.9458581244561625`*^9}, {3.9458581712232485`*^9, 
   3.945858287576553*^9}, {3.9458585091067147`*^9, 3.945858601427623*^9}, 
   3.945858733282503*^9, {3.9458588029277906`*^9, 3.9458588263548594`*^9}, {
   3.945858873174306*^9, 3.9458589834486904`*^9}, {3.9458591059596786`*^9, 
   3.9458591076191926`*^9}, 3.9459495146200933`*^9, {3.9459502181774454`*^9, 
   3.9459502190898056`*^9}, {3.946016953175202*^9, 3.946017001778607*^9}, {
   3.946984015291422*^9, 3.946984017403344*^9}, {3.9469844545113244`*^9, 
   3.946984504472471*^9}, {3.9469846174722967`*^9, 3.9469846496343575`*^9}, {
   3.9470061043465805`*^9, 3.9470061151298485`*^9}, {3.9470071838590064`*^9, 
   3.9470071907042713`*^9}, {3.9470072538967476`*^9, 
   3.9470073096009636`*^9}, {3.9496928690552387`*^9, 3.949692883590691*^9}, {
   3.949693117012442*^9, 3.949693154958316*^9}, {3.9496932084017544`*^9, 
   3.949693255693243*^9}, {3.949713398360937*^9, 3.9497134715479193`*^9}, 
   3.949719677448493*^9, {3.972607641852859*^9, 3.972607817650025*^9}, {
   3.972607944535616*^9, 3.9726079833046722`*^9}, {3.9726080360212736`*^9, 
   3.9726080364702244`*^9}, {3.972608125367695*^9, 3.9726081271131215`*^9}, {
   3.9726081965429363`*^9, 3.9726082492294497`*^9}, 3.9726082845142365`*^9, {
   3.972608323503852*^9, 3.9726083253123198`*^9}, {3.9726085826775427`*^9, 
   3.9726085863162594`*^9}, {3.97260888144193*^9, 3.972608934623062*^9}, {
   3.9726089972451687`*^9, 3.9726090397293034`*^9}, {3.972609148566188*^9, 
   3.9726092303942194`*^9}, {3.9726093734573045`*^9, 3.972609387542034*^9}, {
   3.9726094451455665`*^9, 3.9726094699086957`*^9}, 3.972609539550637*^9, {
   3.972610584551302*^9, 3.9726106100379686`*^9}, {3.9726106584804926`*^9, 
   3.972610683494337*^9}, 3.972611361740309*^9, {3.9726114010491776`*^9, 
   3.972611423634432*^9}, {3.972611459790798*^9, 3.9726115570385876`*^9}, 
   3.9726116034850683`*^9, {3.9726116775009537`*^9, 3.9726117196294565`*^9}, 
   3.9726123886114454`*^9, {3.9726142495341997`*^9, 3.9726142567979517`*^9}, {
   3.9726143215507283`*^9, 3.972614321693203*^9}, {3.9726143939764*^9, 
   3.9726144188437767`*^9}, {3.9726146403448286`*^9, 
   3.9726146434962907`*^9}, {3.972614717729133*^9, 3.9726147270549707`*^9}, {
   3.9726149485249195`*^9, 3.972614955784259*^9}, {3.9726155181814327`*^9, 
   3.9726155494130354`*^9}, {3.9726159021067467`*^9, 3.972615908640072*^9}, {
   3.972615945589489*^9, 3.9726159582999887`*^9}, {3.972616388457403*^9, 
   3.9726164122721767`*^9}, {3.9726172708985543`*^9, 
   3.9726173055107136`*^9}, {3.9726181203117695`*^9, 3.97261819969432*^9}, {
   3.9732978956897464`*^9, 3.9732979076255813`*^9}, {3.973298010059373*^9, 
   3.9732980494480023`*^9}, {3.9733015752060423`*^9, 3.9733015861782637`*^9}, 
   3.9733032376056547`*^9, 3.9733035295150995`*^9, {3.97364756584667*^9, 
   3.973647570101308*^9}, 3.9736477571198883`*^9, {3.9737037411004615`*^9, 
   3.9737037758493643`*^9}, {3.973703836545075*^9, 3.973703859238641*^9}, 
   3.973703959237891*^9, {3.9737040106706967`*^9, 3.973704022833918*^9}, {
   3.9737040593216715`*^9, 3.973704096014453*^9}, {3.9737041317665205`*^9, 
   3.9737041956764708`*^9}, {3.9737046549537454`*^9, 
   3.9737046575079594`*^9}, {3.973714142709649*^9, 3.973714143319195*^9}, 
   3.973714186806254*^9, 3.9737309476601224`*^9, {3.973730991765731*^9, 
   3.9737310344513836`*^9}, {3.9737311462104435`*^9, 3.973731166249269*^9}, {
   3.9737324563061523`*^9, 3.9737324726645875`*^9}, 3.973790001078894*^9, {
   3.9737900449608283`*^9, 3.973790050883015*^9}, 3.973790118647768*^9, {
   3.9737902236933565`*^9, 3.973790260833208*^9}, {3.9738859367507195`*^9, 
   3.9738859759380474`*^9}, {3.9738868343267255`*^9, 
   3.973886836848172*^9}},ExpressionUUID->"d8cbb832-18e9-4cf8-aa3a-\
1d3497861780"]
}, Open  ]]
},
Evaluator->"Local",
WindowSize->{541.5, 729.75},
WindowMargins->{{Automatic, -1446}, {Automatic, 3.75}},
Magnification:>0.7 Inherited,
FrontEndVersion->"13.3 for Microsoft Windows (64-bit) (July 24, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"9ab850cc-aa16-458c-b2eb-fae982cbf9b6"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 422, 6, 68, "Title",ExpressionUUID->"1f5da4ee-bde6-40e6-94c6-2c14c5b91140"],
Cell[1005, 30, 1539, 28, 185, "Text",ExpressionUUID->"2eff1238-b8f3-4bf1-911a-30d35120656e"],
Cell[2547, 60, 12788, 243, 331, "Code",ExpressionUUID->"78502ec7-6974-45c9-a8b9-f8873999f31b"],
Cell[15338, 305, 150371, 3538, 7604, "Input",ExpressionUUID->"d8cbb832-18e9-4cf8-aa3a-1d3497861780"]
}, Open  ]]
}
]
*)

